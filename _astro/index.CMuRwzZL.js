import{r as a}from"./index.Cd_vQiNd.js";let i=[],s=0;const c=4;let p=n=>{let r=[],e={get(){return e.lc||e.listen(()=>{})(),e.value},lc:0,listen(t){return e.lc=r.push(t),()=>{for(let u=s+c;u<i.length;)i[u]===t?i.splice(u,c):u+=c;let l=r.indexOf(t);~l&&(r.splice(l,1),--e.lc||e.off())}},notify(t,l){let u=!i.length;for(let f of r)i.push(f,e.value,t,l);if(u){for(s=0;s<i.length;s+=c)i[s](i[s+1],i[s+2],i[s+3]);i.length=0}},off(){},set(t){let l=e.value;l!==t&&(e.value=t,e.notify(l))},subscribe(t){let l=e.listen(t);return t(e.value),l},value:n};return e};function d(n,r,e){let t=new Set(r).add(void 0);return n.listen((l,u,f)=>{t.has(f)&&e(l,u,f)})}let o=(n,r)=>e=>{n.current!==e&&(n.current=e,r())};function S(n,{keys:r,deps:e=[n,r]}={}){let t=a.useRef();t.current=n.get();let l=a.useCallback(f=>(o(t,f)(n.value),r?.length>0?d(n,r,o(t,f)):n.listen(o(t,f))),e),u=()=>t.current;return a.useSyncExternalStore(l,u,u)}export{p as a,S as u};
