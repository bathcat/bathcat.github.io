<!DOCTYPE html> <html lang="en"> <head><!-- Google tag (gtag.js)--><script type="text/partytown" src="https://www.googletagmanager.com/gtag/js?id=G-GRBB86L642"></script> <script type="module">window.dataLayer=window.dataLayer||[];function a(n){window.dataLayer.push(n)}a(["js",new Date]);a(["config","G-GRBB86L642"]);</script> <script type="module" src="/_astro/BaseHead.astro_astro_type_script_index_0_lang.C-2S3G34.js"></script> <meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/_astro/ClientRouter.astro_astro_type_script_index_0_lang.e0ly9D74.js"></script> <!-- Global Metadata --> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text style=%22filter: brightness(.5) grayscale(1)%22 y=%22.9em%22 font-size=%2290%22>üêà</text></svg>"> <!-- Canonical URL --> <link rel="canonical" href="https://bathcat.net/writing/review-effect/"> <!-- Primary Meta Tags --> <meta name="title" content="Review: Effect"> <meta name="description" content="Very smart. Demands commitment."> <title>Review: Effect</title><link rel="stylesheet" href="/_astro/_collection_.C4LMja1A.css">
<link rel="stylesheet" href="/_astro/_collection_.uwTnT2Ft.css"><script type="module" src="/_astro/page.CtpI7X2x.js"></script>
<script>!(function(w,p,f,c){if(!window.crossOriginIsolated && !navigator.serviceWorker) return;c=w[p]=Object.assign(w[p]||{},{"lib":"/~partytown/","debug":false});c[f]=(c[f]||[]).concat(["datalayer.push"])})(window,'partytown','forward');/* Partytown 0.11.2 - MIT QwikDev */
const t={preserveBehavior:!1},e=e=>{if("string"==typeof e)return[e,t];const[n,r=t]=e;return[n,{...t,...r}]},n=Object.freeze((t=>{const e=new Set;let n=[];do{Object.getOwnPropertyNames(n).forEach((t=>{"function"==typeof n[t]&&e.add(t)}))}while((n=Object.getPrototypeOf(n))!==Object.prototype);return Array.from(e)})());!function(t,r,o,i,a,s,c,l,d,p,u=t,f){function h(){f||(f=1,"/"==(c=(s.lib||"/~partytown/")+(s.debug?"debug/":""))[0]&&(d=r.querySelectorAll('script[type="text/partytown"]'),i!=t?i.dispatchEvent(new CustomEvent("pt1",{detail:t})):(l=setTimeout(v,(null==s?void 0:s.fallbackTimeout)||1e4),r.addEventListener("pt0",w),a?y(1):o.serviceWorker?o.serviceWorker.register(c+(s.swPath||"partytown-sw.js"),{scope:c}).then((function(t){t.active?y():t.installing&&t.installing.addEventListener("statechange",(function(t){"activated"==t.target.state&&y()}))}),console.error):v())))}function y(e){p=r.createElement(e?"script":"iframe"),t._pttab=Date.now(),e||(p.style.display="block",p.style.width="0",p.style.height="0",p.style.border="0",p.style.visibility="hidden",p.setAttribute("aria-hidden",!0)),p.src=c+"partytown-"+(e?"atomics.js?v=0.11.2":"sandbox-sw.html?"+t._pttab),r.querySelector(s.sandboxParent||"body").appendChild(p)}function v(n,o){for(w(),i==t&&(s.forward||[]).map((function(n){const[r]=e(n);delete t[r.split(".")[0]]})),n=0;n<d.length;n++)(o=r.createElement("script")).innerHTML=d[n].innerHTML,o.nonce=s.nonce,r.head.appendChild(o);p&&p.parentNode.removeChild(p)}function w(){clearTimeout(l)}s=t.partytown||{},i==t&&(s.forward||[]).map((function(r){const[o,{preserveBehavior:i}]=e(r);u=t,o.split(".").map((function(e,r,o){var a;u=u[o[r]]=r+1<o.length?u[o[r]]||(a=o[r+1],n.includes(a)?[]:{}):(()=>{let e=null;if(i){const{methodOrProperty:n,thisObject:r}=((t,e)=>{let n=t;for(let t=0;t<e.length-1;t+=1)n=n[e[t]];return{thisObject:n,methodOrProperty:e.length>0?n[e[e.length-1]]:void 0}})(t,o);"function"==typeof n&&(e=(...t)=>n.apply(r,...t))}return function(){let n;return e&&(n=e(arguments)),(t._ptf=t._ptf||[]).push(o,arguments),n}})()}))})),"complete"==r.readyState?h():(t.addEventListener("DOMContentLoaded",h),t.addEventListener("load",h))}(window,document,navigator,top,window.crossOriginIsolated);;(e=>{e.addEventListener("astro:before-swap",e=>{let r=document.body.querySelector("iframe[src*='/~partytown/']");if(r)e.newDocument.body.append(r)})})(document);</script></head> <body> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();</script><script>(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="ELArK" component-url="/_astro/BackgroundAnimation.CYDO4CKX.js" component-export="Sol" renderer-url="/_astro/client.BfPWZUkF.js" props="{&quot;data-astro-transition-persist&quot;:[0,&quot;astro-uqdcbxsp-1&quot;]}" ssr client="only" opts="{&quot;name&quot;:&quot;Sol&quot;,&quot;value&quot;:&quot;react&quot;}" data-astro-transition-persist="astro-uqdcbxsp-1"></astro-island> <astro-island uid="Z2k2RNr" component-url="/_astro/ClientSideHeader.C7VdiXBU.js" component-export="ClientSideHeader" renderer-url="/_astro/client.BfPWZUkF.js" props="{}" ssr client="only" opts="{&quot;name&quot;:&quot;ClientSideHeader&quot;,&quot;value&quot;:&quot;react&quot;}" await-children><header class="pb-6"> <nav class="bc-nav-header"> <astro-island uid="ko8Fp" component-url="/_astro/Menu.B4WKOn5I.js" component-export="Menu" renderer-url="/_astro/client.BfPWZUkF.js" props="{}" ssr client="only" opts="{&quot;name&quot;:&quot;Menu&quot;,&quot;value&quot;:&quot;react&quot;}"></astro-island> </nav> </header><template data-astro-template="fallback"><header class="pb-6"> <nav class="bc-nav-header"> <astro-island uid="ko8Fp" component-url="/_astro/Menu.B4WKOn5I.js" component-export="Menu" renderer-url="/_astro/client.BfPWZUkF.js" props="{}" ssr client="only" opts="{&quot;name&quot;:&quot;Menu&quot;,&quot;value&quot;:&quot;react&quot;}"></astro-island> </nav> </header></template><!--astro:end--></astro-island>  <main class="flex justify-center "><div class=" max-w-3xl px-4 text-center m-0 bg-white bg-opacity-80 dark:bg-gray-900 dark:bg-opacity-70 dark:text-gray-300 text-gray-800"> <nav class="flex py-4" aria-label="Breadcrumb"><ol class="inline-flex items-center space-x-1 md:space-x-2 rtl:space-x-reverse"><li class="inline-flex items-center"><a href="/" class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white">Home</a></li><li class="inline-flex items-center"><svg class="w-3 h-3 mr-3 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 5 7 7-7 7"></path></svg><a href="/writing" class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white">Writing</a></li><li class="inline-flex items-center" aria-current="page"><svg class="w-3 h-3 mr-3 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 5 7 7-7 7"></path></svg><span class="text-sm font-medium text-gray-500 dark:text-gray-400">Review: Effect</span></li></ol></nav> <div class="prose"> <div class="flex flex-col place-content-center text-left"><h1 class="text-5xl text-left">Review: Effect</h1><div class="font-mono text-lg mb-2">Very smart. Demands commitment.</div><div class="font-mono"><time dateTime="2024-12-15T07:00:00.000Z">Dec 15, 2024</time></div></div> <div class="m-6 p-2 border-b-2 dark:border-gray-800 w-3/5 justify-self-center h-0"></div>  <h2 id="whats-effect">What‚Äôs Effect?</h2>
<p><a href="https://effect.website/" rel="nofollow" target="_blank"><strong>Effect</strong></a> is a lot of things: a standard library for TypeScript, a system for
handling errors via the type ssytem, a unifying pattern for async and in-process code, and a lifestyle
choice.</p>
<p>(BTW, this isn‚Äôt really an introduction to effect. There are a <a href="https://www.sandromaglione.com/articles/how-to-model-TypeScript-app-with-effect-docgen" rel="nofollow" target="_blank">lot</a>
<a href="https://medium.com/@alexanderknips/if-you-are-unfamiliar-with-effect-systems-zio-or-effect-ts-i-recommend-reading-the-following-8a7bc51124a4" rel="nofollow" target="_blank">of</a>
<a href="https://www.typeonce.dev/course/effect-beginners-complete-getting-started" rel="nofollow" target="_blank">those</a>. Rather, this
is a review, like a book review. Hopefully this will help you decide whether Effect might help on your
project.)</p>
<p>Here‚Äôs the best summary of Effect. Someone‚Äî I can‚Äôt remember who‚Äî said that <strong>Effect is React for services</strong>.
Fundamentally React consists of a useful primitive for building UIs‚Äî the jsx component‚Äî and a standard library
and ecosystem built around that useful primitive. Similarly, Effect is a suite of tools build around a primitive for building
composable workflows‚Äîthe <code>Effect</code> type. That‚Äôs the selling point: You can wire together atomic pieces
of functionality without the assembly introducing too much additional complexity.</p>
<p>That sounds nice‚Äî and I‚Äôll discuss what it means below‚Äî but it comes at a price. If you watch videos
on Effect or read blog posts, you‚Äôll be familiar with a chart like this:</p>

<div class="flex gap-5 place-content-center text-xl font-semibold"><div><span>With Effect </span><span class="text-red-400 text-2xl">‚¨õÔ∏é</span></div><div><span>Without Effect </span><span class="text-blue-400 text-2xl">‚¨õÔ∏é</span></div></div>
<p><svg aria-roledescription="xychart" role="graphics-document document" viewBox="0 0 700 400" style="max-width:700px" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-0"><style>#mermaid-0{font-family:arial,sans-serif;font-size:16px;fill:#333;}#mermaid-0 .error-icon{fill:#552222;}#mermaid-0 .error-text{fill:#552222;stroke:#552222;}#mermaid-0 .edge-thickness-normal{stroke-width:2px;}#mermaid-0 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-0 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-0 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-0 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-0 .marker{fill:#333333;stroke:#333333;}#mermaid-0 .marker.cross{stroke:#333333;}#mermaid-0 svg{font-family:arial,sans-serif;font-size:16px;}#mermaid-0 :root{--mermaid-font-family:arial,sans-serif;}</style><g></g><g class="main"><rect fill="white" class="background" height="400" width="700"></rect><g class="plot"><g class="line-plot-0"><path stroke-width="2" stroke="#ECECFF" fill="none" d="M43,306L125.125,299.2L207.25,292.4L289.375,282.2L371.5,272L453.625,261.8L535.75,248.2L617.875,234.6L700,221"></path></g><g class="line-plot-1"><path stroke-width="2" stroke="#8493A6" fill="none" d="M43,357L135.391,340L227.781,312.8L320.172,275.4L412.563,221L504.953,170L597.344,105.4L689.734,0"></path></g></g><g class="bottom-axis"><g class="axis-line"><path stroke-width="2" stroke="#131300" fill="none" d="M 43,358 L 700,358"></path></g><g class="title"><text transform="translate(371.5, 367) rotate(0)" text-anchor="middle" dominant-baseline="text-before-edge" font-size="22" fill="#131300" y="0" x="0">Project Size</text></g></g><g class="left-axis"><g class="axisl-line"><path stroke-width="2" stroke="#131300" fill="none" d="M 42,0 L 42,357"></path></g><g class="title"><text transform="translate(8, 178.5) rotate(270)" text-anchor="middle" dominant-baseline="text-before-edge" font-size="22" fill="#131300" y="0" x="0">Codebase Complexity</text></g></g></g><g class="mermaid-tmp-group"></g></svg></p>
<br/>
<p>Which I think is the essential part: Effect is an investment. It takes extra work to learn and
extra work to build with and get the typing right, and extra work unwrapping effects. With sufficiently
complex projects, the initial investment pays for itself by reducing overall complexity.</p>
<p>Effect isn‚Äôt always a sensible investment. If your application is simple and UI-centric, Effect is not
for you. Don‚Äôt make an Effect-based meditation timer for the app store.</p>
<p>Even if you‚Äôre building services, the investment may not pay off. Because a lot of this depends on your
team. Things that lower the break-even point:</p>
<ul>
<li>Experience with Effect</li>
<li>Experience with functional programming</li>
<li>Experience with TypeScript</li>
<li>Willingness to learn</li>
</ul>
<h2 id="effect-the-useful-primitive">Effect: the Useful Primitive</h2>
<p>It might be nice if Effect were just a bunch of normal and useful TypeScript stuff packaged into a
single library. But it‚Äôs not just that. Because <em>Effect is also a pattern</em> for working with the core
primitive. And because most of the ‚Äòstandard library‚Äô conforms to that pattern, using the standard
library in your code requires you to use the pattern.</p>
<p>It‚Äôs kind of like Angular verses React. You can‚Äôt use some React hook library inside your Angular
component because the two technologies are build around different primitives with different
mechanisms for composability.</p>
<p>Because at its core, Effect is a type, <code>Effect.Effect</code> that represents three things:</p>
<ol>
<li>A lazily executable function</li>
<li>Possible failures</li>
<li>Ambient dependencies</li>
</ol>
<p>Here‚Äôs a fake example:</p>
<div class="expressive-code"><style>.expressive-code{font-family:var(--ec-uiFontFml);font-size:var(--ec-uiFontSize);font-weight:var(--ec-uiFontWg);line-height:var(--ec-uiLineHt);text-size-adjust:none;-webkit-text-size-adjust:none}.expressive-code *:not(:is(svg, svg *)){all:revert;box-sizing:border-box}.expressive-code pre{display:flex;margin:0;padding:0;border:var(--ec-brdWd) solid var(--ec-brdCol);border-radius:calc(var(--ec-brdRad) + var(--ec-brdWd));background:var(--ec-codeBg)}.expressive-code pre:focus-visible{outline:3px solid var(--ec-focusBrd);outline-offset:-3px}.expressive-code pre > code{all:unset;display:block;flex:1 0 100%;padding:var(--ec-codePadBlk) 0;color:var(--ec-codeFg);font-family:var(--ec-codeFontFml);font-size:var(--ec-codeFontSize);font-weight:var(--ec-codeFontWg);line-height:var(--ec-codeLineHt)}.expressive-code pre{overflow-x:auto}.expressive-code pre.wrap .ec-line .code{white-space:pre-wrap;overflow-wrap:break-word;min-width:min(20ch, var(--ecMaxLine, 20ch))}.expressive-code pre.wrap .ec-line .code span.indent{white-space:pre}.expressive-code pre::-webkit-scrollbar,.expressive-code pre::-webkit-scrollbar-track{background-color:inherit;border-radius:calc(var(--ec-brdRad) + var(--ec-brdWd));border-top-left-radius:0;border-top-right-radius:0}.expressive-code pre::-webkit-scrollbar-thumb{background-color:var(--ec-sbThumbCol);border:4px solid transparent;background-clip:content-box;border-radius:10px}.expressive-code pre::-webkit-scrollbar-thumb:hover{background-color:var(--ec-sbThumbHoverCol)}.expressive-code .ec-line{direction:ltr;unicode-bidi:isolate;display:grid;grid-template-areas:'gutter code';grid-template-columns:auto 1fr;position:relative}.expressive-code .ec-line .gutter{grid-area:gutter;color:var(--ec-gtrFg)}.expressive-code .ec-line .gutter > *{pointer-events:none;user-select:none;-webkit-user-select:none}.expressive-code .ec-line .gutter ~ .code{--ecLineBrdCol:var(--ec-gtrBrdCol)}.expressive-code .ec-line.highlight .gutter{color:var(--ec-gtrHlFg)}.expressive-code .ec-line .code{grid-area:code;position:relative;box-sizing:content-box;padding-inline-start:calc(var(--ecIndent, 0ch) + var(--ec-codePadInl) - var(--ecGtrBrdWd));padding-inline-end:var(--ec-codePadInl);text-indent:calc(var(--ecIndent, 0ch) * -1)}.expressive-code .ec-line .code::before,.expressive-code .ec-line .code::after,.expressive-code .ec-line .code :where(*){text-indent:0}.expressive-code .ec-line .code{--ecGtrBrdWd:var(--ec-gtrBrdWd);border-inline-start:var(--ecGtrBrdWd) solid var(--ecLineBrdCol, transparent)}.expressive-code .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}.expressive-code .ec-line.mark{--tmLineBgCol:var(--ec-tm-markBg)}.expressive-code .ec-line.mark .code{--ecLineBrdCol:var(--ec-tm-markBrdCol)}.expressive-code .ec-line.ins{--tmLineBgCol:var(--ec-tm-insBg);--tmLabel:var(--ec-tm-insDiffIndContent)}.expressive-code .ec-line.ins .code{--ecLineBrdCol:var(--ec-tm-insBrdCol)}.expressive-code .ec-line.ins .code::before{color:var(--ec-tm-insDiffIndCol)}.expressive-code .ec-line.del{--tmLineBgCol:var(--ec-tm-delBg);--tmLabel:var(--ec-tm-delDiffIndContent)}.expressive-code .ec-line.del .code{--ecLineBrdCol:var(--ec-tm-delBrdCol)}.expressive-code .ec-line.del .code::before{color:var(--ec-tm-delDiffIndCol)}.expressive-code .ec-line.mark,.expressive-code .ec-line.ins,.expressive-code .ec-line.del{background:var(--tmLineBgCol)}.expressive-code .ec-line.mark .code,.expressive-code .ec-line.ins .code,.expressive-code .ec-line.del .code{--ecGtrBrdWd:var(--ec-tm-lineMarkerAccentWd)}.expressive-code .ec-line.mark .code::before,.expressive-code .ec-line.ins .code::before,.expressive-code .ec-line.del .code::before{display:block;position:absolute;left:0;box-sizing:border-box;content:var(--tmLabel, ' ');padding-inline-start:var(--ec-tm-lineDiffIndMargLeft);text-align:center;white-space:pre}.expressive-code .ec-line.mark.tm-label .code::before,.expressive-code .ec-line.ins.tm-label .code::before,.expressive-code .ec-line.del.tm-label .code::before{background:var(--ecLineBrdCol);padding:0 calc(var(--ec-tm-lineMarkerLabelPadInl) + var(--ec-tm-lineMarkerAccentWd)) 0 var(--ec-tm-lineMarkerLabelPadInl);color:var(--ec-tm-lineMarkerLabelCol)}.expressive-code .ec-line mark{--tmInlineBgCol:var(--ec-tm-markBg);--tmInlineBrdCol:var(--ec-tm-markBrdCol)}.expressive-code .ec-line ins{--tmInlineBgCol:var(--ec-tm-insBg);--tmInlineBrdCol:var(--ec-tm-insBrdCol)}.expressive-code .ec-line del{--tmInlineBgCol:var(--ec-tm-delBg);--tmInlineBrdCol:var(--ec-tm-delBrdCol)}.expressive-code .ec-line mark,.expressive-code .ec-line ins,.expressive-code .ec-line del{all:unset;display:inline-block;position:relative;--tmBrdL:var(--ec-tm-inlMarkerBrdWd);--tmBrdR:var(--ec-tm-inlMarkerBrdWd);--tmRadL:var(--ec-tm-inlMarkerBrdRad);--tmRadR:var(--ec-tm-inlMarkerBrdRad);margin-inline:0.025rem;padding-inline:var(--ec-tm-inlMarkerPad);border-radius:var(--tmRadL) var(--tmRadR) var(--tmRadR) var(--tmRadL);background:var(--tmInlineBgCol);background-clip:padding-box}.expressive-code .ec-line mark.open-start,.expressive-code .ec-line ins.open-start,.expressive-code .ec-line del.open-start{margin-inline-start:0;padding-inline-start:0;--tmBrdL:0px;--tmRadL:0}.expressive-code .ec-line mark.open-end,.expressive-code .ec-line ins.open-end,.expressive-code .ec-line del.open-end{margin-inline-end:0;padding-inline-end:0;--tmBrdR:0px;--tmRadR:0}.expressive-code .ec-line mark::before,.expressive-code .ec-line ins::before,.expressive-code .ec-line del::before{content:'';position:absolute;pointer-events:none;display:inline-block;inset:0;border-radius:var(--tmRadL) var(--tmRadR) var(--tmRadR) var(--tmRadL);border:var(--ec-tm-inlMarkerBrdWd) solid var(--tmInlineBrdCol);border-inline-width:var(--tmBrdL) var(--tmBrdR)}.expressive-code .frame{all:unset;position:relative;display:block;--header-border-radius:calc(var(--ec-brdRad) + var(--ec-brdWd));--tab-border-radius:calc(var(--ec-frm-edTabBrdRad) + var(--ec-brdWd));--button-spacing:0.4rem;--code-background:var(--ec-frm-edBg);border-radius:var(--header-border-radius);box-shadow:var(--ec-frm-frameBoxShdCssVal)}.expressive-code .frame .header{display:none;z-index:1;position:relative;border-radius:var(--header-border-radius) var(--header-border-radius) 0 0}.expressive-code .frame.has-title pre,.expressive-code .frame.has-title code,.expressive-code .frame.is-terminal pre,.expressive-code .frame.is-terminal code{border-top:none;border-top-left-radius:0;border-top-right-radius:0}.expressive-code .frame .title:empty:before{content:'\a0'}.expressive-code .frame.has-title:not(.is-terminal){--button-spacing:calc(1.9rem + 2 * (var(--ec-uiPadBlk) + var(--ec-frm-edActTabIndHt)))}.expressive-code .frame.has-title:not(.is-terminal) .title{position:relative;color:var(--ec-frm-edActTabFg);background:var(--ec-frm-edActTabBg);background-clip:padding-box;margin-block-start:var(--ec-frm-edTabsMargBlkStart);padding:calc(var(--ec-uiPadBlk) + var(--ec-frm-edActTabIndHt)) var(--ec-uiPadInl);border:var(--ec-brdWd) solid var(--ec-frm-edActTabBrdCol);border-radius:var(--tab-border-radius) var(--tab-border-radius) 0 0;border-bottom:none;overflow:hidden}.expressive-code .frame.has-title:not(.is-terminal) .title::after{content:'';position:absolute;pointer-events:none;inset:0;border-top:var(--ec-frm-edActTabIndHt) solid var(--ec-frm-edActTabIndTopCol);border-bottom:var(--ec-frm-edActTabIndHt) solid var(--ec-frm-edActTabIndBtmCol)}.expressive-code .frame.has-title:not(.is-terminal) .header{display:flex;background:linear-gradient(to top, var(--ec-frm-edTabBarBrdBtmCol) var(--ec-brdWd), transparent var(--ec-brdWd)),linear-gradient(var(--ec-frm-edTabBarBg), var(--ec-frm-edTabBarBg));background-repeat:no-repeat;padding-inline-start:var(--ec-frm-edTabsMargInlStart)}.expressive-code .frame.has-title:not(.is-terminal) .header::before{content:'';position:absolute;pointer-events:none;inset:0;border:var(--ec-brdWd) solid var(--ec-frm-edTabBarBrdCol);border-radius:inherit;border-bottom:none}.expressive-code .frame.is-terminal{--button-spacing:calc(1.9rem + var(--ec-brdWd) + 2 * var(--ec-uiPadBlk));--code-background:var(--ec-frm-trmBg)}.expressive-code .frame.is-terminal .header{display:flex;align-items:center;justify-content:center;padding-block:var(--ec-uiPadBlk);padding-block-end:calc(var(--ec-uiPadBlk) + var(--ec-brdWd));position:relative;font-weight:500;letter-spacing:0.025ch;color:var(--ec-frm-trmTtbFg);background:var(--ec-frm-trmTtbBg);border:var(--ec-brdWd) solid var(--ec-brdCol);border-bottom:none}.expressive-code .frame.is-terminal .header::before{content:'';position:absolute;pointer-events:none;left:var(--ec-uiPadInl);width:2.1rem;height:0.56rem;line-height:0;background-color:var(--ec-frm-trmTtbDotsFg);opacity:var(--ec-frm-trmTtbDotsOpa);-webkit-mask-image:var(--ec-frm-trmIcon);-webkit-mask-repeat:no-repeat;mask-image:var(--ec-frm-trmIcon);mask-repeat:no-repeat}.expressive-code .frame.is-terminal .header::after{content:'';position:absolute;pointer-events:none;inset:0;border-bottom:var(--ec-brdWd) solid var(--ec-frm-trmTtbBrdBtmCol)}.expressive-code .frame pre{background:var(--code-background)}.expressive-code .copy{display:flex;gap:0.25rem;flex-direction:row;position:absolute;inset-block-start:calc(var(--ec-brdWd) + var(--button-spacing));inset-inline-end:calc(var(--ec-brdWd) + var(--ec-uiPadInl) / 2)}@media (scripting: none){.expressive-code .copy{display:none}}.expressive-code .copy{direction:ltr;unicode-bidi:isolate}.expressive-code .copy button{position:relative;align-self:flex-end;margin:0;padding:0;border:none;border-radius:0.2rem;z-index:1;cursor:pointer;transition-property:opacity, background, border-color;transition-duration:0.2s;transition-timing-function:cubic-bezier(0.25, 0.46, 0.45, 0.94);width:2.5rem;height:2.5rem;background:var(--code-background);opacity:0.75}.expressive-code .copy button div{position:absolute;inset:0;border-radius:inherit;background:var(--ec-frm-inlBtnBg);opacity:var(--ec-frm-inlBtnBgIdleOpa);transition-property:inherit;transition-duration:inherit;transition-timing-function:inherit}.expressive-code .copy button::before{content:'';position:absolute;pointer-events:none;inset:0;border-radius:inherit;border:var(--ec-brdWd) solid var(--ec-frm-inlBtnBrd);opacity:var(--ec-frm-inlBtnBrdOpa)}.expressive-code .copy button::after{content:'';position:absolute;pointer-events:none;inset:0;background-color:var(--ec-frm-inlBtnFg);-webkit-mask-image:var(--ec-frm-copyIcon);-webkit-mask-repeat:no-repeat;mask-image:var(--ec-frm-copyIcon);mask-repeat:no-repeat;margin:0.475rem;line-height:0}.expressive-code .copy button:hover,.expressive-code .copy button:focus:focus-visible{opacity:1}.expressive-code .copy button:hover div,.expressive-code .copy button:focus:focus-visible div{opacity:var(--ec-frm-inlBtnBgHoverOrFocusOpa)}.expressive-code .copy button:active{opacity:1}.expressive-code .copy button:active div{opacity:var(--ec-frm-inlBtnBgActOpa)}.expressive-code .copy .feedback{--tooltip-arrow-size:0.35rem;--tooltip-bg:var(--ec-frm-tooltipSuccessBg);color:var(--ec-frm-tooltipSuccessFg);pointer-events:none;user-select:none;-webkit-user-select:none;position:relative;align-self:center;background-color:var(--tooltip-bg);z-index:99;padding:0.125rem 0.75rem;border-radius:0.2rem;margin-inline-end:var(--tooltip-arrow-size);opacity:0;transition-property:opacity, transform;transition-duration:0.2s;transition-timing-function:ease-in-out;transform:translate3d(0, 0.25rem, 0)}.expressive-code .copy .feedback::after{content:'';position:absolute;pointer-events:none;top:calc(50% - var(--tooltip-arrow-size));inset-inline-end:calc(-2 * (var(--tooltip-arrow-size) - 0.5px));border:var(--tooltip-arrow-size) solid transparent;border-inline-start-color:var(--tooltip-bg)}.expressive-code .copy .feedback.show{opacity:1;transform:translate3d(0, 0, 0)}@media (hover: hover){.expressive-code{}.expressive-code .copy button{opacity:0;width:2rem;height:2rem}.expressive-code .frame:hover .copy button:not(:hover),.expressive-code .frame:focus-within :focus-visible ~ .copy button:not(:hover),.expressive-code .frame .copy .feedback.show ~ button:not(:hover){opacity:0.75}}.expressive-code :nth-child(1 of .ec-line) .code{padding-inline-end:calc(2rem + var(--ec-codePadInl))}.expressive-code .gutter .ln{display:inline-flex;justify-content:flex-end;align-items:flex-start;box-sizing:content-box;min-width:var(--lnWidth, 2ch);padding-inline:2ch;color:var(--ec-lineNumbers-fg)}.highlight .expressive-code .gutter .ln{color:var(--ec-lineNumbers-hlFg)}:root .main-pane{z-index:1}.expressive-code:hover .twoslash-hover:not(.twoslash-hover:hover){border-color:rgba(from var(--ec-twoSlash-hoverUnderlineCol) r g b / 0.4)}@media (min-width: 500px){.expressive-code .twoslash-popup-container:before{content:"";position:absolute;top:-5px;left:3px;border-top:1px solid var(--ec-twoSlash-brdCol);border-right:1px solid var(--ec-twoSlash-brdCol);background:var(--ec-twoSlash-bg);transform:rotate(-45deg);width:8px;height:8px;pointer-events:none;display:inline-block}}.expressive-code .twoslash-popup-container{position:absolute;z-index:999 !important;background:var(--ec-twoSlash-bg);border:1px solid var(--ec-twoSlash-brdCol);border-radius:4px;font-size:90%;white-space:nowrap !important;word-break:normal !important;overflow-wrap:normal !important;width:max-content !important;margin-top:0.5rem;color:var(--ec-twoSlash-textCol)}.expressive-code .twoslash-popup-container a:link{color:var(--ec-twoSlash-linkCol)}.expressive-code .twoslash-popup-container a:hover{color:var(--ec-twoSlash-linkColHover)}.expressive-code .twoslash-popup-container a:visited{color:var(--ec-twoSlash-linkColVisited)}.expressive-code .twoslash-popup-container a:active{color:var(--ec-twoSlash-linkColAct)}.expressive-code .twoslash-static-container{display:block;z-index:10;background:var(--ec-twoSlash-bg);border:1px solid var(--ec-twoSlash-brdCol);border-radius:4px;font-size:90%;white-space:nowrap !important;word-break:normal !important;overflow-wrap:normal !important;width:max-content !important}.expressive-code .twoslash-static-container a:link{color:var(--ec-twoSlash-linkCol)}.expressive-code .twoslash-static-container a:hover{color:var(--ec-twoSlash-linkColHover)}.expressive-code .twoslash-static-container a:visited{color:var(--ec-twoSlash-linkColVisited)}.expressive-code .twoslash-static-container a:active{color:var(--ec-twoSlash-linkColAct)}.expressive-code .twoslash-static-container:before{content:"";position:absolute;top:-4px;left:2px;border-top:1px solid var(--ec-twoSlash-brdCol);border-right:1px solid var(--ec-twoSlash-brdCol);background:var(--ec-twoSlash-bg);transform:rotate(-45deg);width:10px;height:10px;pointer-events:none;display:inline-block}.expressive-code .twoslash-static-container *{white-space:wrap !important;word-break:normal !important;overflow-wrap:normal !important}.expressive-code .twoslash,.expressive-code .twoslash-noline{position:relative}@media (prefers-reduced-motion: reduce){.expressive-code .twoslash *,.expressive-code .twoslash-noline *{transition:none !important}}.expressive-code .twoslash .twoslash-hover{position:relative;border-bottom:1px dashed transparent;transition-timing-function:ease;transition:border-color 0.3s}.expressive-code .twoslash:hover .twoslash-hover{border-color:var(--ec-twoSlash-hoverUnderlineCol)}.expressive-code .twoslash-popup-code{display:block;width:100%;max-width:600px;padding:6px 12px;font-size:var(--ec-codeFontSize);font-weight:400;line-height:var(--ec-codeLineHt);white-space:pre-wrap}.expressive-code .twoslash-popup-code,.expressive-code .twoslash-popup-code span{white-space:preserve !important}.expressive-code .twoslash-popup-code-type{font-family:var(--ec-codeFontFml);font-weight:600}.expressive-code .twoslash-popup-code-type .frame pre{display:contents !important}.expressive-code .twoslash-popup-code-type .frame .ec-line{display:unset !important}.expressive-code .twoslash-popup-code-type .frame .ec-line .code{padding-inline-start:0 !important;border-inline-start:none !important}.expressive-code .twoslash-popup-code-type .frame pre > code{padding:0 !important}.expressive-code .twoslash-popup-code-type .frame{box-shadow:none !important}.expressive-code .twoslash-popup-docs .frame{box-shadow:none !important}.expressive-code .twoslash-popup-code-type .frame .header::before{border:none !important}.expressive-code .twoslash-popup-code::-webkit-scrollbar,.expressive-code .twoslash-popup-code::-webkit-scrollbar-track,.expressive-code .twoslash-popup-docs::-webkit-scrollbar,.expressive-code .twoslash-popup-docs::-webkit-scrollbar-track{background-color:inherit;border-radius:calc(var(--ec-brdRad) + var(--ec-brdWd));border-top-left-radius:0;border-top-right-radius:0}.expressive-code .twoslash-popup-code::-webkit-scrollbar-thumb,.expressive-code .twoslash-popup-docs::-webkit-scrollbar-thumb{background-color:var(--ec-sbThumbCol);border:4px solid transparent;background-clip:content-box;border-radius:10px}.expressive-code .twoslash-popup-code::-webkit-scrollbar-thumb:hover,.expressive-code .twoslash-popup-docs::-webkit-scrollbar-thumb:hover{background-color:var(--ec-sbThumbHoverCol)}.expressive-code .twoslash-popup-code::-webkit-scrollbar-corner,.expressive-code .twoslash-popup-docs::-webkit-scrollbar-corner{background:transparent;width:0;height:0}.expressive-code .twoslash-popup-code,.expressive-code .twoslash-popup-docs{max-height:var(--ec-twoSlash-popupDocsMaxHt) !important;overflow:auto !important}.expressive-code .twoslash-popup-docs{max-width:600px;padding-left:12px;padding-right:12px;padding-top:6px;padding-bottom:6px;border-top:1px solid var(--ec-twoSlash-brdCol);font-size:var(--ec-codeFontSize);font-weight:400;line-height:var(--ec-codeLineHt);text-wrap:balance}.expressive-code .twoslash-popup-docs code{font-family:var(--ec-codeFontFml);font-weight:var(--ec-codeFontWg)}.expressive-code .twoslash-popup-docs-tagline{display:flex;text-wrap-style:stable}.expressive-code .twoslash-popup-docs-tag-name{color:var(--ec-twoSlash-tagCol);font-style:italic;--shiki-dark-font-style:italic;font-weight:500;margin-right:0.25rem}.expressive-code .twoslash-popup-docs-tag-value{margin-left:0.25rem}.expressive-code .twoslash-popup-docs pre{width:100%;background-color:var(--ec-frm-edBg) !important;padding:.15rem;border-radius:4px !important;position:relative !important;font-family:var(--ec-codeFontFml);display:inline-block !important;line-height:var(--ec-codeLineHt);border:var(--ec-brdWd) solid var(--ec-twoSlash-brdCol) !important}.expressive-code .twoslash-popup-docs.twoslash-popup-docs-tags{font-size:14px !important;margin:0 !important;padding-top:0 !important;padding-bottom:0 !important;padding-left:12px !important;padding-right:12px !important}.expressive-code .twoslash-popup-docs > pre > code{border:none !important;outline:none !important;width:100% !important;padding:0.15rem !important}.expressive-code .twoslash-popup-docs code{background-color:var(--ec-frm-edBg) !important;padding:.125rem !important;border-radius:4px !important;position:relative !important;display:inline-block !important;line-height:var(--ec-codeLineHt)}.expressive-code .twoslash-popup-docs-tag-value code,.expressive-code .twoslash-popup-docs > p > code,.expressive-code .twoslash-popup-docs > p > a > code,.expressive-code .twoslash-popup-docs > ul > li > code{border:1px solid var(--ec-twoSlash-brdCol);border-radius:4px}.expressive-code .twoslash-popup-docs code span::after{content:none !important}.expressive-code .twoslash .twoslash-completion{position:relative;margin-top:0.1rem}.expressive-code .twoslash-completion-container{display:flex;flex-direction:column;z-index:10;background:var(--ec-twoSlash-completionBoxBg);border:1px solid var(--ec-twoSlash-completionBoxBrd);border-radius:4px;font-size:90%;white-space:nowrap !important;word-break:normal !important;overflow-wrap:normal !important;width:max-content !important;padding:0.15rem;padding-left:0.25rem;padding-right:0.25rem}.expressive-code .twoslash-cursor{content:" ";width:3px;height:18px;background-color:var(--ec-twoSlash-cursorCol);display:inline-block;margin-left:1px;animation:cursor-blink 1.5s steps(2) infinite;align-self:center}@keyframes cursor-blink{0%{opacity:0}}.expressive-code .twoslash-completion-container *{white-space:wrap !important;word-break:normal !important;overflow-wrap:normal !important}.expressive-code .twoslash-completion-item{overflow:hidden;display:flex;align-items:center;gap:0.25em}.expressive-code .twoslash-completion-item:hover{background:var(--ec-twoSlash-completionBoxHoverBg)}.expressive-code .twoslash-completion-item-separator{border-top:1px solid var(--ec-twoSlash-completionBoxBrd)}.expressive-code .twoslash-completion-item-deprecated{text-decoration:line-through;opacity:0.5}.expressive-code .twoslash-completion-name{font-weight:400}.expressive-code .twoslash-completion-name-unmatched{color:var(--ec-twoSlash-completionBoxCol)}.expressive-code .twoslash-completion-name-matched{color:var(--ec-twoSlash-completionBoxMatchedCol);font-weight:600}.expressive-code .twoslash-completion-icon{color:var(--ec-twoSlash-completionBoxCol);margin-right:0.2rem;width:1em;flex:none}.expressive-code .twoslash-completion-icon.class{color:var(--ec-twoSlash-completionIconClass)}.expressive-code .twoslash-completion-icon.constructor{color:var(--ec-twoSlash-completionIconConstructor)}.expressive-code .twoslash-completion-icon.function{color:var(--ec-twoSlash-completionIconFunction)}.expressive-code .twoslash-completion-icon.interface{color:var(--ec-twoSlash-completionIconInterface)}.expressive-code .twoslash-completion-icon.module{color:var(--ec-twoSlash-completionIconModule)}.expressive-code .twoslash-completion-icon.method{color:var(--ec-twoSlash-completionIconMethod)}.expressive-code .twoslash-completion-icon.property{color:var(--ec-twoSlash-completionIconProperty)}.expressive-code .twoslash-completion-icon.string{color:var(--ec-twoSlash-completionIconString)}.expressive-code .twoslash-noline .twoslash-static{position:relative}.expressive-code .twoslash.twoerror{display:flex}.expressive-code .twoslash-error-underline{text-decoration-line:spelling-error;position:relative}.expressive-code .twoslash-error-box{display:flex;z-index:10;padding:0.1rem 0.3rem;border-radius:0.2rem;font-style:italic;border:1px solid var(--ec-twoSlash-brdCol);border-radius:4px;font-size:90%;white-space:nowrap !important;word-break:normal !important;overflow-wrap:normal !important;flex:0 1 100%}.expressive-code .twoslash-error-box .twoslash-error-box-icon,.expressive-code .twoslash-error-box .twoslash-error-box-content{display:inline-block;vertical-align:middle}.expressive-code .twoslash-error-box-content{flex:0 1 100%}.expressive-code .twoslash-error-box-content-message{white-space:normal}.expressive-code .twoslash-error-level-error{color:var(--ec-twoSlash-errorCol) !important;border-color:rgba(from var(--ec-twoSlash-errorCol) r g b / 0.25) !important;background:rgba(from var(--ec-twoSlash-errorCol) r g b / 0.1) !important}.expressive-code .twoslash-error-level-warning{color:var(--ec-twoSlash-warnCol) !important;border-color:rgba(from var(--ec-twoSlash-warnCol) r g b / 0.25) !important;background:rgba(from var(--ec-twoSlash-warnCol) r g b / 0.1) !important}.expressive-code .twoslash-error-level-suggestion{color:var(--ec-twoSlash-suggestionCol) !important;border-color:rgba(from var(--ec-twoSlash-suggestionCol) r g b / 0.25) !important;background:rgba(from var(--ec-twoSlash-suggestionCol) r g b / 0.1) !important}.expressive-code .twoslash-error-level-message{color:var(--ec-twoSlash-messageCol) !important;border-color:rgba(from var(--ec-twoSlash-messageCol) r g b / 0.25) !important;background:rgba(from var(--ec-twoSlash-messageCol) r g b / 0.1) !important}.expressive-code .twoslash-highlighted{background-color:var(--ec-twoSlash-hlBg);border:1px solid var(--ec-twoSlash-hlBrdCol);padding:1px 2px;margin:-1px -3px;border-radius:4px}.expressive-code .twoslash-custom-box{margin-left:0rem;margin-right:0rem;padding-left:0.5rem;padding-right:0.5rem;display:block;z-index:10;padding:0.1rem 0.3rem;border-radius:0.2rem;font-style:italic;border:1px solid var(--ec-twoSlash-brdCol);border-radius:4px;font-size:90%;white-space:nowrap !important;word-break:normal !important;overflow-wrap:normal !important;width:100% !important}.expressive-code .twoslash-custom-box .twoslash-custom-box-icon,.expressive-code .twoslash-custom-box .twoslash-custom-box-content{display:inline-block;vertical-align:middle}.expressive-code .twoslash-custom-box .twoslash-custom-box-icon{margin-right:0.5rem;height:1rem;width:1rem}.expressive-code .twoslash-custom-level-error{color:var(--ec-twoSlash-errorCol) !important;border-color:rgba(from var(--ec-twoSlash-errorCol) r g b / 0.25) !important;background:rgba(from var(--ec-twoSlash-errorCol) r g b / 0.1) !important}.expressive-code .twoslash-custom-level-warning{color:var(--ec-twoSlash-warnCol) !important;border-color:rgba(from var(--ec-twoSlash-warnCol) r g b / 0.25) !important;background:rgba(from var(--ec-twoSlash-warnCol) r g b / 0.1) !important}.expressive-code .twoslash-custom-level-suggestion{color:var(--ec-twoSlash-suggestionCol) !important;border-color:rgba(from var(--ec-twoSlash-suggestionCol) r g b / 0.25) !important;background:rgba(from var(--ec-twoSlash-suggestionCol) r g b / 0.1) !important}.expressive-code .twoslash-custom-level-message{color:var(--ec-twoSlash-messageCol) !important;border-color:rgba(from var(--ec-twoSlash-messageCol) r g b / 0.25) !important;background:rgba(from var(--ec-twoSlash-messageCol) r g b / 0.1) !important}.expressive-code .ec-section{position:relative}.expressive-code .ec-section summary{position:relative;font-family:var(--ec-cs-closedFontFml);font-size:var(--ec-cs-closedFontSize);line-height:var(--ec-cs-closedLineHt);user-select:none;-webkit-user-select:none;cursor:pointer;color:var(--ec-cs-closedTextCol);background-color:var(--ec-cs-closedBgCol);--border-color:var(--ec-cs-closedBrdCol);--border-width:var(--ec-cs-closedBrdWd);box-shadow:inset 0 calc(-1 * var(--border-width)) var(--border-color), inset 0 var(--border-width) var(--border-color);margin:var(--ec-cs-closedMarg);padding:0}.expressive-code .ec-section summary::marker{display:inline-block;content:"";width:16px;height:16px}.expressive-code .ec-section summary::-webkit-details-marker{display:none}.expressive-code .ec-section summary :is(.expand, .collapse){position:relative;display:inline-block;width:16px;height:16px;vertical-align:text-bottom;opacity:0.75}.expressive-code .ec-section summary :is(.expand, .collapse)::after{content:'';position:absolute;pointer-events:none;inset:0;background-color:var(--ec-cs-closedTextCol);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;line-height:0}.expressive-code .ec-section summary .expand::after{-webkit-mask-image:var(--ec-cs-expandIcon);mask-image:var(--ec-cs-expandIcon);-webkit-print-color-adjust:exact;print-color-adjust:exact}.expressive-code .ec-section summary .collapse{display:none}.expressive-code .ec-section summary .collapse::after{-webkit-mask-image:var(--ec-cs-collapseIcon);mask-image:var(--ec-cs-collapseIcon)}.expressive-code .ec-section summary .text{margin-left:1em}.expressive-code .ec-section summary .ec-line .code{padding-block:var(--ec-cs-closedPadBlk);text-indent:0}.expressive-code .ec-section[open],.expressive-code .ec-section details[open] + .content-lines{--border-color:var(--ec-cs-openBrdCol);--border-width:var(--ec-cs-openBrdWd);box-shadow:inset 0 calc(-1 * var(--border-width)) var(--border-color), inset 0 var(--border-width) var(--border-color);padding-inline:var(--ec-cs-openPad);margin-inline:var(--ec-cs-openMarg)}.expressive-code .ec-section.github[open] summary{display:none}.expressive-code .ec-section.github[open]{background-color:var(--ec-cs-openBgCol)}.expressive-code .ec-section:is(.collapsible-start, .collapsible-end){display:flex;flex-direction:column}.expressive-code .ec-section:is(.collapsible-start, .collapsible-end) .content-lines{display:none}.expressive-code .ec-section:is(.collapsible-start, .collapsible-end) details[open] .collapse{display:inline-block}.expressive-code .ec-section:is(.collapsible-start, .collapsible-end) details[open] :is(.expand, .text){display:none}.expressive-code .ec-section:is(.collapsible-start, .collapsible-end) details[open] + .content-lines{display:block;background-color:var(--ec-cs-openBgColCollapsible)}@media print{.expressive-code .ec-section:is(.collapsible-start, .collapsible-end) details[open]{display:none}}.expressive-code .ec-section.collapsible-end{flex-direction:column-reverse}:root,:root:not([data-theme='github-dark']) .expressive-code[data-theme='github-dark']{--ec-brdRad:0.3rem;--ec-brdWd:1.5px;--ec-brdCol:#1b1f23;--ec-codeFontFml:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,'Liberation Mono','Courier New',monospace;--ec-codeFontSize:0.85rem;--ec-codeFontWg:400;--ec-codeLineHt:1.65;--ec-codePadBlk:1rem;--ec-codePadInl:1.35rem;--ec-codeBg:#24292e;--ec-codeFg:#e1e4e8;--ec-codeSelBg:#3392ff44;--ec-gtrFg:#727980;--ec-gtrBrdCol:#72798033;--ec-gtrBrdWd:1.5px;--ec-gtrHlFg:#e1e4e896;--ec-uiFontFml:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';--ec-uiFontSize:0.9rem;--ec-uiFontWg:400;--ec-uiLineHt:1.65;--ec-uiPadBlk:0.25rem;--ec-uiPadInl:1rem;--ec-uiSelBg:#39414a;--ec-uiSelFg:#e1e4e8;--ec-focusBrd:#005cc5;--ec-sbThumbCol:#6a737d33;--ec-sbThumbHoverCol:#6a737dd1;--ec-tm-lineMarkerAccentMarg:0rem;--ec-tm-lineMarkerAccentWd:0.15rem;--ec-tm-lineMarkerLabelPadInl:0.2rem;--ec-tm-lineMarkerLabelCol:white;--ec-tm-lineDiffIndMargLeft:0.3rem;--ec-tm-inlMarkerBrdWd:1.5px;--ec-tm-inlMarkerBrdRad:0.2rem;--ec-tm-inlMarkerPad:0.15rem;--ec-tm-insDiffIndContent:'+';--ec-tm-delDiffIndContent:'-';--ec-tm-markBg:#264a8980;--ec-tm-markBrdCol:#5570b3d0;--ec-tm-insBg:#26561c80;--ec-tm-insBrdCol:#4e7e41d0;--ec-tm-insDiffIndCol:#7eb070d0;--ec-tm-delBg:#81322b80;--ec-tm-delBrdCol:#ae594fd0;--ec-tm-delDiffIndCol:#e68a7ed0;--ec-frm-shdCol:#0000005b;--ec-frm-frameBoxShdCssVal:0.1rem 0.1rem 0.2rem #0000005b;--ec-frm-edActTabBg:#24292e;--ec-frm-edActTabFg:#e1e4e8;--ec-frm-edActTabBrdCol:transparent;--ec-frm-edActTabIndHt:1.5px;--ec-frm-edActTabIndTopCol:#f9826c;--ec-frm-edActTabIndBtmCol:#24292e;--ec-frm-edTabsMargInlStart:0;--ec-frm-edTabsMargBlkStart:0;--ec-frm-edTabBrdRad:0.3rem;--ec-frm-edTabBarBg:#1f2428;--ec-frm-edTabBarBrdCol:#1b1f23;--ec-frm-edTabBarBrdBtmCol:#1b1f23;--ec-frm-edBg:#24292e;--ec-frm-trmTtbFg:#e1e4e8;--ec-frm-trmTtbDotsFg:#e1e4e8;--ec-frm-trmTtbDotsOpa:0.15;--ec-frm-trmTtbBg:#24292e;--ec-frm-trmTtbBrdBtmCol:#1b1f23;--ec-frm-trmBg:#1f2428;--ec-frm-inlBtnFg:#e1e4e8;--ec-frm-inlBtnBg:#e1e4e8;--ec-frm-inlBtnBgIdleOpa:0;--ec-frm-inlBtnBgHoverOrFocusOpa:0.2;--ec-frm-inlBtnBgActOpa:0.3;--ec-frm-inlBtnBrd:#e1e4e8;--ec-frm-inlBtnBrdOpa:0.4;--ec-frm-tooltipSuccessBg:#228739;--ec-frm-tooltipSuccessFg:white;--ec-frm-copyIcon:url("data:image/svg+xml,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2024%2024'%20fill%3D'none'%20stroke%3D'black'%20stroke-width%3D'1.75'%3E%3Cpath%20d%3D'M3%2019a2%202%200%200%201-1-2V2a2%202%200%200%201%201-1h13a2%202%200%200%201%202%201'%2F%3E%3Crect%20x%3D'6'%20y%3D'5'%20width%3D'16'%20height%3D'18'%20rx%3D'1.5'%20ry%3D'1.5'%2F%3E%3C%2Fsvg%3E");--ec-frm-trmIcon:url("data:image/svg+xml,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2060%2016'%20preserveAspectRatio%3D'xMidYMid%20meet'%3E%3Ccircle%20cx%3D'8'%20cy%3D'8'%20r%3D'8'%2F%3E%3Ccircle%20cx%3D'30'%20cy%3D'8'%20r%3D'8'%2F%3E%3Ccircle%20cx%3D'52'%20cy%3D'8'%20r%3D'8'%2F%3E%3C%2Fsvg%3E");--ec-lineNumbers-fg:inherit;--ec-lineNumbers-hlFg:inherit;--ec-twoSlash-brdCol:#1b1f23;--ec-twoSlash-bg:#24292e;--ec-twoSlash-hoverUnderlineCol:#e1e4e8;--ec-twoSlash-textCol:#e1e4e8;--ec-twoSlash-popupDocsMaxHt:200px;--ec-twoSlash-tagCol:#79b8ff;--ec-twoSlash-linkCol:#79b8ff;--ec-twoSlash-linkColVisited:#b392f0;--ec-twoSlash-linkColHover:#56d4dd;--ec-twoSlash-linkColAct:#85e89d;--ec-twoSlash-hlBg:#264a8980;--ec-twoSlash-hlBrdCol:#5570b3d0;--ec-twoSlash-errorCol:#ea4a5a;--ec-twoSlash-warnCol:#ffea7f;--ec-twoSlash-suggestionCol:#34d058;--ec-twoSlash-messageCol:#2188ff;--ec-twoSlash-cursorCol:#c8e1ff;--ec-twoSlash-completionBoxBg:#24292e;--ec-twoSlash-completionBoxBrd:#1b1f23;--ec-twoSlash-completionBoxCol:#e1e4e8;--ec-twoSlash-completionBoxMatchedCol:#ffd33d44;--ec-twoSlash-completionBoxHoverBg:#ffd33d22;--ec-twoSlash-completionIconClass:#EE9D28;--ec-twoSlash-completionIconConstructor:#b180d7;--ec-twoSlash-completionIconFunction:#b180d7;--ec-twoSlash-completionIconInterface:#75beff;--ec-twoSlash-completionIconModule:#cccccc;--ec-twoSlash-completionIconMethod:#b180d7;--ec-twoSlash-completionIconProperty:#cccccc;--ec-twoSlash-completionIconString:#cccccc;--ec-cs-closedBrdWd:0px;--ec-cs-closedPadBlk:4px;--ec-cs-closedMarg:0;--ec-cs-closedFontFml:inherit;--ec-cs-closedFontSize:inherit;--ec-cs-closedLineHt:inherit;--ec-cs-closedTextCol:#e1e4e8;--ec-cs-closedBgCol:#58606933;--ec-cs-closedBrdCol:#58606980;--ec-cs-openBrdWd:1px;--ec-cs-openPad:0;--ec-cs-openMarg:0;--ec-cs-openBgCol:transparent;--ec-cs-openBgColCollapsible:#5860691a;--ec-cs-openBrdCol:transparent;--ec-cs-expandIcon:url("data:image/svg+xml,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2016%2016'%3E%3Cpath%20d%3D'm8.177.677%202.896%202.896a.25.25%200%200%201-.177.427H8.75v1.25a.75.75%200%200%201-1.5%200V4H5.104a.25.25%200%200%201-.177-.427L7.823.677a.25.25%200%200%201%20.354%200ZM7.25%2010.75a.75.75%200%200%201%201.5%200V12h2.146a.25.25%200%200%201%20.177.427l-2.896%202.896a.25.25%200%200%201-.354%200l-2.896-2.896A.25.25%200%200%201%205.104%2012H7.25v-1.25Zm-5-2a.75.75%200%200%200%200-1.5h-.5a.75.75%200%200%200%200%201.5h.5ZM6%208a.75.75%200%200%201-.75.75h-.5a.75.75%200%200%201%200-1.5h.5A.75.75%200%200%201%206%208Zm2.25.75a.75.75%200%200%200%200-1.5h-.5a.75.75%200%200%200%200%201.5h.5ZM12%208a.75.75%200%200%201-.75.75h-.5a.75.75%200%200%201%200-1.5h.5A.75.75%200%200%201%2012%208Zm2.25.75a.75.75%200%200%200%200-1.5h-.5a.75.75%200%200%200%200%201.5h.5Z'%2F%3E%3C%2Fsvg%3E");--ec-cs-collapseIcon:url("data:image/svg+xml,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2016%2016'%3E%3Cpath%20d%3D'M10.896%202H8.75V.75a.75.75%200%200%200-1.5%200V2H5.104a.25.25%200%200%200-.177.427l2.896%202.896a.25.25%200%200%200%20.354%200l2.896-2.896A.25.25%200%200%200%2010.896%202ZM8.75%2015.25a.75.75%200%200%201-1.5%200V14H5.104a.25.25%200%200%201-.177-.427l2.896-2.896a.25.25%200%200%201%20.354%200l2.896%202.896a.25.25%200%200%201-.177.427H8.75v1.25Zm-6.5-6.5a.75.75%200%200%200%200-1.5h-.5a.75.75%200%200%200%200%201.5h.5ZM6%208a.75.75%200%200%201-.75.75h-.5a.75.75%200%200%201%200-1.5h.5A.75.75%200%200%201%206%208Zm2.25.75a.75.75%200%200%200%200-1.5h-.5a.75.75%200%200%200%200%201.5h.5ZM12%208a.75.75%200%200%201-.75.75h-.5a.75.75%200%200%201%200-1.5h.5A.75.75%200%200%201%2012%208Zm2.25.75a.75.75%200%200%200%200-1.5h-.5a.75.75%200%200%200%200%201.5h.5Z'%2F%3E%3C%2Fsvg%3E")}.expressive-code .ec-line :where(span[style^='--']:not([class])),:root:not([data-theme='github-dark']) .expressive-code[data-theme='github-dark'] .ec-line :where(span[style^='--']:not([class])){color:var(--0, inherit);background-color:var(--0bg, transparent);font-style:var(--0fs, inherit);font-weight:var(--0fw, inherit);text-decoration:var(--0td, inherit)}@media (prefers-color-scheme: light){:root:not([data-theme='github-dark']){--ec-brdCol:#e1e4e8;--ec-codeBg:#fff;--ec-codeFg:#24292e;--ec-codeSelBg:#0366d625;--ec-gtrFg:#1b1f2381;--ec-gtrBrdCol:#1b1f2333;--ec-gtrHlFg:#24292eab;--ec-uiSelBg:#e2e5e9;--ec-uiSelFg:#2f363d;--ec-focusBrd:#2188ff;--ec-sbThumbCol:#959da533;--ec-sbThumbHoverCol:#959da5eb;--ec-tm-markBg:#9fb6ff80;--ec-tm-insBg:#94c68480;--ec-tm-insDiffIndCol:#3a692fd0;--ec-tm-delBg:#fea09280;--ec-tm-delDiffIndCol:#97453dd0;--ec-frm-shdCol:#00000028;--ec-frm-frameBoxShdCssVal:0.1rem 0.1rem 0.2rem #00000028;--ec-frm-edActTabBg:#fff;--ec-frm-edActTabFg:#2f363d;--ec-frm-edActTabIndBtmCol:#fff;--ec-frm-edTabBarBg:#f6f8fa;--ec-frm-edTabBarBrdCol:#e1e4e8;--ec-frm-edTabBarBrdBtmCol:#e1e4e8;--ec-frm-edBg:#fff;--ec-frm-trmTtbFg:#2f363d;--ec-frm-trmTtbDotsFg:#2f363d;--ec-frm-trmTtbBg:#fff;--ec-frm-trmTtbBrdBtmCol:#e1e4e8;--ec-frm-trmBg:#f6f8fa;--ec-frm-inlBtnFg:#24292e;--ec-frm-inlBtnBg:#24292e;--ec-frm-inlBtnBrd:#24292e;--ec-frm-tooltipSuccessBg:#208638;--ec-twoSlash-brdCol:#e1e4e8;--ec-twoSlash-bg:#fff;--ec-twoSlash-hoverUnderlineCol:#24292e;--ec-twoSlash-textCol:#24292e;--ec-twoSlash-tagCol:#005cc5;--ec-twoSlash-linkCol:#005cc5;--ec-twoSlash-linkColVisited:#5a32a3;--ec-twoSlash-linkColHover:#3192aa;--ec-twoSlash-linkColAct:#22863a;--ec-twoSlash-hlBg:#9fb6ff80;--ec-twoSlash-errorCol:#d73a49;--ec-twoSlash-warnCol:#dbab09;--ec-twoSlash-suggestionCol:#28a745;--ec-twoSlash-messageCol:#0366d6;--ec-twoSlash-cursorCol:#044289;--ec-twoSlash-completionBoxBg:#fff;--ec-twoSlash-completionBoxBrd:#e1e4e8;--ec-twoSlash-completionBoxCol:#24292e;--ec-twoSlash-completionBoxMatchedCol:#ffdf5d;--ec-twoSlash-completionBoxHoverBg:#ffdf5d66;--ec-cs-closedTextCol:#24292e;--ec-cs-closedBgCol:#d1d5da33;--ec-cs-closedBrdCol:#d1d5da80;--ec-cs-openBgColCollapsible:#d1d5da1a}:root:not([data-theme='github-dark']) .expressive-code .ec-line :where(span[style^='--']:not([class])){color:var(--1, inherit);background-color:var(--1bg, transparent);font-style:var(--1fs, inherit);font-weight:var(--1fw, inherit);text-decoration:var(--1td, inherit)}}:root[data-theme='github-light'] .expressive-code:not([data-theme='github-dark']),.expressive-code[data-theme='github-light']{--ec-brdCol:#e1e4e8;--ec-codeBg:#fff;--ec-codeFg:#24292e;--ec-codeSelBg:#0366d625;--ec-gtrFg:#1b1f2381;--ec-gtrBrdCol:#1b1f2333;--ec-gtrHlFg:#24292eab;--ec-uiSelBg:#e2e5e9;--ec-uiSelFg:#2f363d;--ec-focusBrd:#2188ff;--ec-sbThumbCol:#959da533;--ec-sbThumbHoverCol:#959da5eb;--ec-tm-markBg:#9fb6ff80;--ec-tm-insBg:#94c68480;--ec-tm-insDiffIndCol:#3a692fd0;--ec-tm-delBg:#fea09280;--ec-tm-delDiffIndCol:#97453dd0;--ec-frm-shdCol:#00000028;--ec-frm-frameBoxShdCssVal:0.1rem 0.1rem 0.2rem #00000028;--ec-frm-edActTabBg:#fff;--ec-frm-edActTabFg:#2f363d;--ec-frm-edActTabIndBtmCol:#fff;--ec-frm-edTabBarBg:#f6f8fa;--ec-frm-edTabBarBrdCol:#e1e4e8;--ec-frm-edTabBarBrdBtmCol:#e1e4e8;--ec-frm-edBg:#fff;--ec-frm-trmTtbFg:#2f363d;--ec-frm-trmTtbDotsFg:#2f363d;--ec-frm-trmTtbBg:#fff;--ec-frm-trmTtbBrdBtmCol:#e1e4e8;--ec-frm-trmBg:#f6f8fa;--ec-frm-inlBtnFg:#24292e;--ec-frm-inlBtnBg:#24292e;--ec-frm-inlBtnBrd:#24292e;--ec-frm-tooltipSuccessBg:#208638;--ec-twoSlash-brdCol:#e1e4e8;--ec-twoSlash-bg:#fff;--ec-twoSlash-hoverUnderlineCol:#24292e;--ec-twoSlash-textCol:#24292e;--ec-twoSlash-tagCol:#005cc5;--ec-twoSlash-linkCol:#005cc5;--ec-twoSlash-linkColVisited:#5a32a3;--ec-twoSlash-linkColHover:#3192aa;--ec-twoSlash-linkColAct:#22863a;--ec-twoSlash-hlBg:#9fb6ff80;--ec-twoSlash-errorCol:#d73a49;--ec-twoSlash-warnCol:#dbab09;--ec-twoSlash-suggestionCol:#28a745;--ec-twoSlash-messageCol:#0366d6;--ec-twoSlash-cursorCol:#044289;--ec-twoSlash-completionBoxBg:#fff;--ec-twoSlash-completionBoxBrd:#e1e4e8;--ec-twoSlash-completionBoxCol:#24292e;--ec-twoSlash-completionBoxMatchedCol:#ffdf5d;--ec-twoSlash-completionBoxHoverBg:#ffdf5d66;--ec-cs-closedTextCol:#24292e;--ec-cs-closedBgCol:#d1d5da33;--ec-cs-closedBrdCol:#d1d5da80;--ec-cs-openBgColCollapsible:#d1d5da1a}:root[data-theme='github-light'] .expressive-code:not([data-theme='github-dark']) .ec-line :where(span[style^='--']:not([class])),.expressive-code[data-theme='github-light'] .ec-line :where(span[style^='--']:not([class])){color:var(--1, inherit);background-color:var(--1bg, transparent);font-style:var(--1fs, inherit);font-weight:var(--1fw, inherit);text-decoration:var(--1td, inherit)}</style><script type="module">try{(()=>{function a(e){if(!e)return;let t=e.getAttribute("tabindex")!==null,r=e.scrollWidth>e.clientWidth;r&&!t?(e.setAttribute("tabindex","0"),e.setAttribute("role","region")):!r&&t&&(e.removeAttribute("tabindex"),e.removeAttribute("role"))}var u=window.requestIdleCallback||(e=>setTimeout(e,1)),s=window.cancelIdleCallback||clearTimeout;function l(e){let t=new Set,r,n;return new ResizeObserver(c=>{c.forEach(o=>t.add(o.target)),r&&clearTimeout(r),n&&s(n),r=setTimeout(()=>{n&&s(n),n=u(()=>{t.forEach(o=>e(o)),t.clear()})},250)})}function i(e,t){e.querySelectorAll?.(".expressive-code pre > code").forEach(r=>{let n=r.parentElement;n&&t.observe(n)})}var d=l(a);i(document,d);var b=new MutationObserver(e=>e.forEach(t=>t.addedNodes.forEach(r=>{i(r,d)})));b.observe(document.body,{childList:!0,subtree:!0});document.addEventListener("astro:page-load",()=>{i(document,d)});})();}catch(e){console.error("[EC] tabindex-js-module failed:",e)}</script><script type="module">try{(()=>{function i(o){let e=document.createElement("pre");Object.assign(e.style,{opacity:"0",pointerEvents:"none",position:"absolute",overflow:"hidden",left:"0",top:"0",width:"20px",height:"20px",webkitUserSelect:"auto",userSelect:"all"}),e.ariaHidden="true",e.textContent=o,document.body.appendChild(e);let a=document.createRange();a.selectNode(e);let n=getSelection();if(!n)return!1;n.removeAllRanges(),n.addRange(a);let r=!1;try{r=document.execCommand("copy")}finally{n.removeAllRanges(),document.body.removeChild(e)}return r}async function l(o){let e=o.currentTarget,a=e.dataset,n=!1,r=a.code.replace(/\u007f/g,`
`);try{await navigator.clipboard.writeText(r),n=!0}catch{n=i(r)}if(!n||e.parentNode?.querySelector(".feedback"))return;let t=document.createElement("div");t.classList.add("feedback"),t.append(a.copied),e.before(t),t.offsetWidth,requestAnimationFrame(()=>t?.classList.add("show"));let c=()=>!t||t.classList.remove("show"),d=()=>{!t||parseFloat(getComputedStyle(t).opacity)>0||(t.remove(),t=void 0)};setTimeout(c,1500),setTimeout(d,2500),e.addEventListener("blur",c),t.addEventListener("transitioncancel",d),t.addEventListener("transitionend",d)}function s(o){o.querySelectorAll?.(".expressive-code .copy button").forEach(e=>e.addEventListener("click",l))}s(document);var u=new MutationObserver(o=>o.forEach(e=>e.addedNodes.forEach(a=>{s(a)})));u.observe(document.body,{childList:!0,subtree:!0});document.addEventListener("astro:page-load",()=>{s(document)});})();}catch(e){console.error("[EC] copy-js-module failed:",e)}</script><script type="module">!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).FloatingUICore={})}(this,(function(t){"use strict";const e=["top","right","bottom","left"],n=["start","end"],i=e.reduce(((t,e)=>t.concat(e,e+"-"+n[0],e+"-"+n[1])),[]),o=Math.min,r=Math.max,a={left:"right",right:"left",bottom:"top",top:"bottom"},l={start:"end",end:"start"};function s(t,e,n){return r(t,o(e,n))}function f(t,e){return"function"==typeof t?t(e):t}function c(t){return t.split("-")[0]}function u(t){return t.split("-")[1]}function m(t){return"x"===t?"y":"x"}function d(t){return"y"===t?"height":"width"}function g(t){return["top","bottom"].includes(c(t))?"y":"x"}function p(t){return m(g(t))}function h(t,e,n){void 0===n&&(n=!1);const i=u(t),o=p(t),r=d(o);let a="x"===o?i===(n?"end":"start")?"right":"left":"start"===i?"bottom":"top";return e.reference[r]>e.floating[r]&&(a=w(a)),[a,w(a)]}function y(t){return t.replace(/start|end/g,(t=>l[t]))}function w(t){return t.replace(/left|right|bottom|top/g,(t=>a[t]))}function x(t){return"number"!=typeof t?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(t):{top:t,right:t,bottom:t,left:t}}function v(t){const{x:e,y:n,width:i,height:o}=t;return{width:i,height:o,top:n,left:e,right:e+i,bottom:n+o,x:e,y:n}}function b(t,e,n){let{reference:i,floating:o}=t;const r=g(e),a=p(e),l=d(a),s=c(e),f="y"===r,m=i.x+i.width/2-o.width/2,h=i.y+i.height/2-o.height/2,y=i[l]/2-o[l]/2;let w;switch(s){case"top":w={x:m,y:i.y-o.height};break;case"bottom":w={x:m,y:i.y+i.height};break;case"right":w={x:i.x+i.width,y:h};break;case"left":w={x:i.x-o.width,y:h};break;default:w={x:i.x,y:i.y}}switch(u(e)){case"start":w[a]-=y*(n&&f?-1:1);break;case"end":w[a]+=y*(n&&f?-1:1)}return w}async function A(t,e){var n;void 0===e&&(e={});const{x:i,y:o,platform:r,rects:a,elements:l,strategy:s}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:m="floating",altBoundary:d=!1,padding:g=0}=f(e,t),p=x(g),h=l[d?"floating"===m?"reference":"floating":m],y=v(await r.getClippingRect({element:null==(n=await(null==r.isElement?void 0:r.isElement(h)))||n?h:h.contextElement||await(null==r.getDocumentElement?void 0:r.getDocumentElement(l.floating)),boundary:c,rootBoundary:u,strategy:s})),w="floating"===m?{x:i,y:o,width:a.floating.width,height:a.floating.height}:a.reference,b=await(null==r.getOffsetParent?void 0:r.getOffsetParent(l.floating)),A=await(null==r.isElement?void 0:r.isElement(b))&&await(null==r.getScale?void 0:r.getScale(b))||{x:1,y:1},R=v(r.convertOffsetParentRelativeRectToViewportRelativeRect?await r.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:w,offsetParent:b,strategy:s}):w);return{top:(y.top-R.top+p.top)/A.y,bottom:(R.bottom-y.bottom+p.bottom)/A.y,left:(y.left-R.left+p.left)/A.x,right:(R.right-y.right+p.right)/A.x}}function R(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function P(t){return e.some((e=>t[e]>=0))}function D(t){const e=o(...t.map((t=>t.left))),n=o(...t.map((t=>t.top)));return{x:e,y:n,width:r(...t.map((t=>t.right)))-e,height:r(...t.map((t=>t.bottom)))-n}}t.arrow=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:i,placement:r,rects:a,platform:l,elements:c,middlewareData:m}=e,{element:g,padding:h=0}=f(t,e)||{};if(null==g)return{};const y=x(h),w={x:n,y:i},v=p(r),b=d(v),A=await l.getDimensions(g),R="y"===v,P=R?"top":"left",D=R?"bottom":"right",T=R?"clientHeight":"clientWidth",O=a.reference[b]+a.reference[v]-w[v]-a.floating[b],E=w[v]-a.reference[v],L=await(null==l.getOffsetParent?void 0:l.getOffsetParent(g));let k=L?L[T]:0;k&&await(null==l.isElement?void 0:l.isElement(L))||(k=c.floating[T]||a.floating[b]);const C=O/2-E/2,B=k/2-A[b]/2-1,H=o(y[P],B),S=o(y[D],B),F=H,j=k-A[b]-S,z=k/2-A[b]/2+C,M=s(F,z,j),V=!m.arrow&&null!=u(r)&&z!==M&&a.reference[b]/2-(z<F?H:S)-A[b]/2<0,W=V?z<F?z-F:z-j:0;return{[v]:w[v]+W,data:{[v]:M,centerOffset:z-M-W,...V&&{alignmentOffset:W}},reset:V}}}),t.autoPlacement=function(t){return void 0===t&&(t={}),{name:"autoPlacement",options:t,async fn(e){var n,o,r;const{rects:a,middlewareData:l,placement:s,platform:m,elements:d}=e,{crossAxis:g=!1,alignment:p,allowedPlacements:w=i,autoAlignment:x=!0,...v}=f(t,e),b=void 0!==p||w===i?function(t,e,n){return(t?[...n.filter((e=>u(e)===t)),...n.filter((e=>u(e)!==t))]:n.filter((t=>c(t)===t))).filter((n=>!t||u(n)===t||!!e&&y(n)!==n))}(p||null,x,w):w,R=await A(e,v),P=(null==(n=l.autoPlacement)?void 0:n.index)||0,D=b[P];if(null==D)return{};const T=h(D,a,await(null==m.isRTL?void 0:m.isRTL(d.floating)));if(s!==D)return{reset:{placement:b[0]}};const O=[R[c(D)],R[T[0]],R[T[1]]],E=[...(null==(o=l.autoPlacement)?void 0:o.overflows)||[],{placement:D,overflows:O}],L=b[P+1];if(L)return{data:{index:P+1,overflows:E},reset:{placement:L}};const k=E.map((t=>{const e=u(t.placement);return[t.placement,e&&g?t.overflows.slice(0,2).reduce(((t,e)=>t+e),0):t.overflows[0],t.overflows]})).sort(((t,e)=>t[1]-e[1])),C=(null==(r=k.filter((t=>t[2].slice(0,u(t[0])?2:3).every((t=>t<=0))))[0])?void 0:r[0])||k[0][0];return C!==s?{data:{index:P+1,overflows:E},reset:{placement:C}}:{}}}},t.computePosition=async(t,e,n)=>{const{placement:i="bottom",strategy:o="absolute",middleware:r=[],platform:a}=n,l=r.filter(Boolean),s=await(null==a.isRTL?void 0:a.isRTL(e));let f=await a.getElementRects({reference:t,floating:e,strategy:o}),{x:c,y:u}=b(f,i,s),m=i,d={},g=0;for(let n=0;n<l.length;n++){const{name:r,fn:p}=l[n],{x:h,y:y,data:w,reset:x}=await p({x:c,y:u,initialPlacement:i,placement:m,strategy:o,middlewareData:d,rects:f,platform:a,elements:{reference:t,floating:e}});c=null!=h?h:c,u=null!=y?y:u,d={...d,[r]:{...d[r],...w}},x&&g<=50&&(g++,"object"==typeof x&&(x.placement&&(m=x.placement),x.rects&&(f=!0===x.rects?await a.getElementRects({reference:t,floating:e,strategy:o}):x.rects),({x:c,y:u}=b(f,m,s))),n=-1)}return{x:c,y:u,placement:m,strategy:o,middlewareData:d}},t.detectOverflow=A,t.flip=function(t){return void 0===t&&(t={}),{name:"flip",options:t,async fn(e){var n,i;const{placement:o,middlewareData:r,rects:a,initialPlacement:l,platform:s,elements:m}=e,{mainAxis:d=!0,crossAxis:p=!0,fallbackPlacements:x,fallbackStrategy:v="bestFit",fallbackAxisSideDirection:b="none",flipAlignment:R=!0,...P}=f(t,e);if(null!=(n=r.arrow)&&n.alignmentOffset)return{};const D=c(o),T=g(l),O=c(l)===l,E=await(null==s.isRTL?void 0:s.isRTL(m.floating)),L=x||(O||!R?[w(l)]:function(t){const e=w(t);return[y(t),e,y(e)]}(l)),k="none"!==b;!x&&k&&L.push(...function(t,e,n,i){const o=u(t);let r=function(t,e,n){const i=["left","right"],o=["right","left"],r=["top","bottom"],a=["bottom","top"];switch(t){case"top":case"bottom":return n?e?o:i:e?i:o;case"left":case"right":return e?r:a;default:return[]}}(c(t),"start"===n,i);return o&&(r=r.map((t=>t+"-"+o)),e&&(r=r.concat(r.map(y)))),r}(l,R,b,E));const C=[l,...L],B=await A(e,P),H=[];let S=(null==(i=r.flip)?void 0:i.overflows)||[];if(d&&H.push(B[D]),p){const t=h(o,a,E);H.push(B[t[0]],B[t[1]])}if(S=[...S,{placement:o,overflows:H}],!H.every((t=>t<=0))){var F,j;const t=((null==(F=r.flip)?void 0:F.index)||0)+1,e=C[t];if(e)return{data:{index:t,overflows:S},reset:{placement:e}};let n=null==(j=S.filter((t=>t.overflows[0]<=0)).sort(((t,e)=>t.overflows[1]-e.overflows[1]))[0])?void 0:j.placement;if(!n)switch(v){case"bestFit":{var z;const t=null==(z=S.filter((t=>{if(k){const e=g(t.placement);return e===T||"y"===e}return!0})).map((t=>[t.placement,t.overflows.filter((t=>t>0)).reduce(((t,e)=>t+e),0)])).sort(((t,e)=>t[1]-e[1]))[0])?void 0:z[0];t&&(n=t);break}case"initialPlacement":n=l}if(o!==n)return{reset:{placement:n}}}return{}}}},t.hide=function(t){return void 0===t&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:i="referenceHidden",...o}=f(t,e);switch(i){case"referenceHidden":{const t=R(await A(e,{...o,elementContext:"reference"}),n.reference);return{data:{referenceHiddenOffsets:t,referenceHidden:P(t)}}}case"escaped":{const t=R(await A(e,{...o,altBoundary:!0}),n.floating);return{data:{escapedOffsets:t,escaped:P(t)}}}default:return{}}}}},t.inline=function(t){return void 0===t&&(t={}),{name:"inline",options:t,async fn(e){const{placement:n,elements:i,rects:a,platform:l,strategy:s}=e,{padding:u=2,x:m,y:d}=f(t,e),p=Array.from(await(null==l.getClientRects?void 0:l.getClientRects(i.reference))||[]),h=function(t){const e=t.slice().sort(((t,e)=>t.y-e.y)),n=[];let i=null;for(let t=0;t<e.length;t++){const o=e[t];!i||o.y-i.y>i.height/2?n.push([o]):n[n.length-1].push(o),i=o}return n.map((t=>v(D(t))))}(p),y=v(D(p)),w=x(u);const b=await l.getElementRects({reference:{getBoundingClientRect:function(){if(2===h.length&&h[0].left>h[1].right&&null!=m&&null!=d)return h.find((t=>m>t.left-w.left&&m<t.right+w.right&&d>t.top-w.top&&d<t.bottom+w.bottom))||y;if(h.length>=2){if("y"===g(n)){const t=h[0],e=h[h.length-1],i="top"===c(n),o=t.top,r=e.bottom,a=i?t.left:e.left,l=i?t.right:e.right;return{top:o,bottom:r,left:a,right:l,width:l-a,height:r-o,x:a,y:o}}const t="left"===c(n),e=r(...h.map((t=>t.right))),i=o(...h.map((t=>t.left))),a=h.filter((n=>t?n.left===i:n.right===e)),l=a[0].top,s=a[a.length-1].bottom;return{top:l,bottom:s,left:i,right:e,width:e-i,height:s-l,x:i,y:l}}return y}},floating:i.floating,strategy:s});return a.reference.x!==b.reference.x||a.reference.y!==b.reference.y||a.reference.width!==b.reference.width||a.reference.height!==b.reference.height?{reset:{rects:b}}:{}}}},t.limitShift=function(t){return void 0===t&&(t={}),{options:t,fn(e){const{x:n,y:i,placement:o,rects:r,middlewareData:a}=e,{offset:l=0,mainAxis:s=!0,crossAxis:u=!0}=f(t,e),d={x:n,y:i},p=g(o),h=m(p);let y=d[h],w=d[p];const x=f(l,e),v="number"==typeof x?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(s){const t="y"===h?"height":"width",e=r.reference[h]-r.floating[t]+v.mainAxis,n=r.reference[h]+r.reference[t]-v.mainAxis;y<e?y=e:y>n&&(y=n)}if(u){var b,A;const t="y"===h?"width":"height",e=["top","left"].includes(c(o)),n=r.reference[p]-r.floating[t]+(e&&(null==(b=a.offset)?void 0:b[p])||0)+(e?0:v.crossAxis),i=r.reference[p]+r.reference[t]+(e?0:(null==(A=a.offset)?void 0:A[p])||0)-(e?v.crossAxis:0);w<n?w=n:w>i&&(w=i)}return{[h]:y,[p]:w}}}},t.offset=function(t){return void 0===t&&(t=0),{name:"offset",options:t,async fn(e){var n,i;const{x:o,y:r,placement:a,middlewareData:l}=e,s=await async function(t,e){const{placement:n,platform:i,elements:o}=t,r=await(null==i.isRTL?void 0:i.isRTL(o.floating)),a=c(n),l=u(n),s="y"===g(n),m=["left","top"].includes(a)?-1:1,d=r&&s?-1:1,p=f(e,t);let{mainAxis:h,crossAxis:y,alignmentAxis:w}="number"==typeof p?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:p.mainAxis||0,crossAxis:p.crossAxis||0,alignmentAxis:p.alignmentAxis};return l&&"number"==typeof w&&(y="end"===l?-1*w:w),s?{x:y*d,y:h*m}:{x:h*m,y:y*d}}(e,t);return a===(null==(n=l.offset)?void 0:n.placement)&&null!=(i=l.arrow)&&i.alignmentOffset?{}:{x:o+s.x,y:r+s.y,data:{...s,placement:a}}}}},t.rectToClientRect=v,t.shift=function(t){return void 0===t&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:i,placement:o}=e,{mainAxis:r=!0,crossAxis:a=!1,limiter:l={fn:t=>{let{x:e,y:n}=t;return{x:e,y:n}}},...u}=f(t,e),d={x:n,y:i},p=await A(e,u),h=g(c(o)),y=m(h);let w=d[y],x=d[h];if(r){const t="y"===y?"bottom":"right";w=s(w+p["y"===y?"top":"left"],w,w-p[t])}if(a){const t="y"===h?"bottom":"right";x=s(x+p["y"===h?"top":"left"],x,x-p[t])}const v=l.fn({...e,[y]:w,[h]:x});return{...v,data:{x:v.x-n,y:v.y-i,enabled:{[y]:r,[h]:a}}}}}},t.size=function(t){return void 0===t&&(t={}),{name:"size",options:t,async fn(e){var n,i;const{placement:a,rects:l,platform:s,elements:m}=e,{apply:d=(()=>{}),...p}=f(t,e),h=await A(e,p),y=c(a),w=u(a),x="y"===g(a),{width:v,height:b}=l.floating;let R,P;"top"===y||"bottom"===y?(R=y,P=w===(await(null==s.isRTL?void 0:s.isRTL(m.floating))?"start":"end")?"left":"right"):(P=y,R="end"===w?"top":"bottom");const D=b-h.top-h.bottom,T=v-h.left-h.right,O=o(b-h[R],D),E=o(v-h[P],T),L=!e.middlewareData.shift;let k=O,C=E;if(null!=(n=e.middlewareData.shift)&&n.enabled.x&&(C=T),null!=(i=e.middlewareData.shift)&&i.enabled.y&&(k=D),L&&!w){const t=r(h.left,0),e=r(h.right,0),n=r(h.top,0),i=r(h.bottom,0);x?C=v-2*(0!==t||0!==e?t+e:r(h.left,h.right)):k=b-2*(0!==n||0!==i?n+i:r(h.top,h.bottom))}await d({...e,availableWidth:C,availableHeight:k});const B=await s.getDimensions(m.floating);return v!==B.width||b!==B.height?{reset:{rects:!0}}:{}}}}}));</script><script type="module">!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@floating-ui/core")):"function"==typeof define&&define.amd?define(["exports","@floating-ui/core"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).FloatingUIDOM={},t.FloatingUICore)}(this,(function(t,e){"use strict";const n=Math.min,o=Math.max,i=Math.round,r=Math.floor,c=t=>({x:t,y:t});function l(){return"undefined"!=typeof window}function s(t){return d(t)?(t.nodeName||"").toLowerCase():"#document"}function f(t){var e;return(null==t||null==(e=t.ownerDocument)?void 0:e.defaultView)||window}function u(t){var e;return null==(e=(d(t)?t.ownerDocument:t.document)||window.document)?void 0:e.documentElement}function d(t){return!!l()&&(t instanceof Node||t instanceof f(t).Node)}function a(t){return!!l()&&(t instanceof Element||t instanceof f(t).Element)}function h(t){return!!l()&&(t instanceof HTMLElement||t instanceof f(t).HTMLElement)}function p(t){return!(!l()||"undefined"==typeof ShadowRoot)&&(t instanceof ShadowRoot||t instanceof f(t).ShadowRoot)}function g(t){const{overflow:e,overflowX:n,overflowY:o,display:i}=b(t);return/auto|scroll|overlay|hidden|clip/.test(e+o+n)&&!["inline","contents"].includes(i)}function m(t){return["table","td","th"].includes(s(t))}function y(t){return[":popover-open",":modal"].some((e=>{try{return t.matches(e)}catch(t){return!1}}))}function w(t){const e=x(),n=a(t)?b(t):t;return"none"!==n.transform||"none"!==n.perspective||!!n.containerType&&"normal"!==n.containerType||!e&&!!n.backdropFilter&&"none"!==n.backdropFilter||!e&&!!n.filter&&"none"!==n.filter||["transform","perspective","filter"].some((t=>(n.willChange||"").includes(t)))||["paint","layout","strict","content"].some((t=>(n.contain||"").includes(t)))}function x(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function v(t){return["html","body","#document"].includes(s(t))}function b(t){return f(t).getComputedStyle(t)}function T(t){return a(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function L(t){if("html"===s(t))return t;const e=t.assignedSlot||t.parentNode||p(t)&&t.host||u(t);return p(e)?e.host:e}function R(t){const e=L(t);return v(e)?t.ownerDocument?t.ownerDocument.body:t.body:h(e)&&g(e)?e:R(e)}function C(t,e,n){var o;void 0===e&&(e=[]),void 0===n&&(n=!0);const i=R(t),r=i===(null==(o=t.ownerDocument)?void 0:o.body),c=f(i);if(r){const t=E(c);return e.concat(c,c.visualViewport||[],g(i)?i:[],t&&n?C(t):[])}return e.concat(i,C(i,[],n))}function E(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function S(t){const e=b(t);let n=parseFloat(e.width)||0,o=parseFloat(e.height)||0;const r=h(t),c=r?t.offsetWidth:n,l=r?t.offsetHeight:o,s=i(n)!==c||i(o)!==l;return s&&(n=c,o=l),{width:n,height:o,$:s}}function F(t){return a(t)?t:t.contextElement}function O(t){const e=F(t);if(!h(e))return c(1);const n=e.getBoundingClientRect(),{width:o,height:r,$:l}=S(e);let s=(l?i(n.width):n.width)/o,f=(l?i(n.height):n.height)/r;return s&&Number.isFinite(s)||(s=1),f&&Number.isFinite(f)||(f=1),{x:s,y:f}}const D=c(0);function H(t){const e=f(t);return x()&&e.visualViewport?{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}:D}function P(t,n,o,i){void 0===n&&(n=!1),void 0===o&&(o=!1);const r=t.getBoundingClientRect(),l=F(t);let s=c(1);n&&(i?a(i)&&(s=O(i)):s=O(t));const u=function(t,e,n){return void 0===e&&(e=!1),!(!n||e&&n!==f(t))&&e}(l,o,i)?H(l):c(0);let d=(r.left+u.x)/s.x,h=(r.top+u.y)/s.y,p=r.width/s.x,g=r.height/s.y;if(l){const t=f(l),e=i&&a(i)?f(i):i;let n=t,o=E(n);for(;o&&i&&e!==n;){const t=O(o),e=o.getBoundingClientRect(),i=b(o),r=e.left+(o.clientLeft+parseFloat(i.paddingLeft))*t.x,c=e.top+(o.clientTop+parseFloat(i.paddingTop))*t.y;d*=t.x,h*=t.y,p*=t.x,g*=t.y,d+=r,h+=c,n=f(o),o=E(n)}}return e.rectToClientRect({width:p,height:g,x:d,y:h})}function W(t,e){const n=T(t).scrollLeft;return e?e.left+n:P(u(t)).left+n}function M(t,e,n){void 0===n&&(n=!1);const o=t.getBoundingClientRect();return{x:o.left+e.scrollLeft-(n?0:W(t,o)),y:o.top+e.scrollTop}}function z(t,n,i){let r;if("viewport"===n)r=function(t,e){const n=f(t),o=u(t),i=n.visualViewport;let r=o.clientWidth,c=o.clientHeight,l=0,s=0;if(i){r=i.width,c=i.height;const t=x();(!t||t&&"fixed"===e)&&(l=i.offsetLeft,s=i.offsetTop)}return{width:r,height:c,x:l,y:s}}(t,i);else if("document"===n)r=function(t){const e=u(t),n=T(t),i=t.ownerDocument.body,r=o(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),c=o(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let l=-n.scrollLeft+W(t);const s=-n.scrollTop;return"rtl"===b(i).direction&&(l+=o(e.clientWidth,i.clientWidth)-r),{width:r,height:c,x:l,y:s}}(u(t));else if(a(n))r=function(t,e){const n=P(t,!0,"fixed"===e),o=n.top+t.clientTop,i=n.left+t.clientLeft,r=h(t)?O(t):c(1);return{width:t.clientWidth*r.x,height:t.clientHeight*r.y,x:i*r.x,y:o*r.y}}(n,i);else{const e=H(t);r={x:n.x-e.x,y:n.y-e.y,width:n.width,height:n.height}}return e.rectToClientRect(r)}function A(t,e){const n=L(t);return!(n===e||!a(n)||v(n))&&("fixed"===b(n).position||A(n,e))}function V(t,e,n){const o=h(e),i=u(e),r="fixed"===n,l=P(t,!0,r,e);let f={scrollLeft:0,scrollTop:0};const d=c(0);if(o||!o&&!r)if(("body"!==s(e)||g(i))&&(f=T(e)),o){const t=P(e,!0,r,e);d.x=t.x+e.clientLeft,d.y=t.y+e.clientTop}else i&&(d.x=W(i));const a=!i||o||r?c(0):M(i,f);return{x:l.left+f.scrollLeft-d.x-a.x,y:l.top+f.scrollTop-d.y-a.y,width:l.width,height:l.height}}function B(t){return"static"===b(t).position}function N(t,e){if(!h(t)||"fixed"===b(t).position)return null;if(e)return e(t);let n=t.offsetParent;return u(t)===n&&(n=n.ownerDocument.body),n}function I(t,e){const n=f(t);if(y(t))return n;if(!h(t)){let e=L(t);for(;e&&!v(e);){if(a(e)&&!B(e))return e;e=L(e)}return n}let o=N(t,e);for(;o&&m(o)&&B(o);)o=N(o,e);return o&&v(o)&&B(o)&&!w(o)?n:o||function(t){let e=L(t);for(;h(e)&&!v(e);){if(w(e))return e;if(y(e))return null;e=L(e)}return null}(t)||n}const k={convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{elements:e,rect:n,offsetParent:o,strategy:i}=t;const r="fixed"===i,l=u(o),f=!!e&&y(e.floating);if(o===l||f&&r)return n;let d={scrollLeft:0,scrollTop:0},a=c(1);const p=c(0),m=h(o);if((m||!m&&!r)&&(("body"!==s(o)||g(l))&&(d=T(o)),h(o))){const t=P(o);a=O(o),p.x=t.x+o.clientLeft,p.y=t.y+o.clientTop}const w=!l||m||r?c(0):M(l,d,!0);return{width:n.width*a.x,height:n.height*a.y,x:n.x*a.x-d.scrollLeft*a.x+p.x+w.x,y:n.y*a.y-d.scrollTop*a.y+p.y+w.y}},getDocumentElement:u,getClippingRect:function(t){let{element:e,boundary:i,rootBoundary:r,strategy:c}=t;const l=[..."clippingAncestors"===i?y(e)?[]:function(t,e){const n=e.get(t);if(n)return n;let o=C(t,[],!1).filter((t=>a(t)&&"body"!==s(t))),i=null;const r="fixed"===b(t).position;let c=r?L(t):t;for(;a(c)&&!v(c);){const e=b(c),n=w(c);n||"fixed"!==e.position||(i=null),(r?!n&&!i:!n&&"static"===e.position&&i&&["absolute","fixed"].includes(i.position)||g(c)&&!n&&A(t,c))?o=o.filter((t=>t!==c)):i=e,c=L(c)}return e.set(t,o),o}(e,this._c):[].concat(i),r],f=l[0],u=l.reduce(((t,i)=>{const r=z(e,i,c);return t.top=o(r.top,t.top),t.right=n(r.right,t.right),t.bottom=n(r.bottom,t.bottom),t.left=o(r.left,t.left),t}),z(e,f,c));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}},getOffsetParent:I,getElementRects:async function(t){const e=this.getOffsetParent||I,n=this.getDimensions,o=await n(t.floating);return{reference:V(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:o.width,height:o.height}}},getClientRects:function(t){return Array.from(t.getClientRects())},getDimensions:function(t){const{width:e,height:n}=S(t);return{width:e,height:n}},getScale:O,isElement:a,isRTL:function(t){return"rtl"===b(t).direction}};const q=e.detectOverflow,U=e.offset,j=e.autoPlacement,X=e.shift,Y=e.flip,$=e.size,_=e.hide,G=e.arrow,J=e.inline,K=e.limitShift;t.arrow=G,t.autoPlacement=j,t.autoUpdate=function(t,e,i,c){void 0===c&&(c={});const{ancestorScroll:l=!0,ancestorResize:s=!0,elementResize:f="function"==typeof ResizeObserver,layoutShift:d="function"==typeof IntersectionObserver,animationFrame:a=!1}=c,h=F(t),p=l||s?[...h?C(h):[],...C(e)]:[];p.forEach((t=>{l&&t.addEventListener("scroll",i,{passive:!0}),s&&t.addEventListener("resize",i)}));const g=h&&d?function(t,e){let i,c=null;const l=u(t);function s(){var t;clearTimeout(i),null==(t=c)||t.disconnect(),c=null}return function f(u,d){void 0===u&&(u=!1),void 0===d&&(d=1),s();const{left:a,top:h,width:p,height:g}=t.getBoundingClientRect();if(u||e(),!p||!g)return;const m={rootMargin:-r(h)+"px "+-r(l.clientWidth-(a+p))+"px "+-r(l.clientHeight-(h+g))+"px "+-r(a)+"px",threshold:o(0,n(1,d))||1};let y=!0;function w(t){const e=t[0].intersectionRatio;if(e!==d){if(!y)return f();e?f(!1,e):i=setTimeout((()=>{f(!1,1e-7)}),1e3)}y=!1}try{c=new IntersectionObserver(w,{...m,root:l.ownerDocument})}catch(t){c=new IntersectionObserver(w,m)}c.observe(t)}(!0),s}(h,i):null;let m,y=-1,w=null;f&&(w=new ResizeObserver((t=>{let[n]=t;n&&n.target===h&&w&&(w.unobserve(e),cancelAnimationFrame(y),y=requestAnimationFrame((()=>{var t;null==(t=w)||t.observe(e)}))),i()})),h&&!a&&w.observe(h),w.observe(e));let x=a?P(t):null;return a&&function e(){const n=P(t);!x||n.x===x.x&&n.y===x.y&&n.width===x.width&&n.height===x.height||i();x=n,m=requestAnimationFrame(e)}(),i(),()=>{var t;p.forEach((t=>{l&&t.removeEventListener("scroll",i),s&&t.removeEventListener("resize",i)})),null==g||g(),null==(t=w)||t.disconnect(),w=null,a&&cancelAnimationFrame(m)}},t.computePosition=(t,n,o)=>{const i=new Map,r={platform:k,...o},c={...r.platform,_c:i};return e.computePosition(t,n,{...r,platform:c})},t.detectOverflow=q,t.flip=Y,t.getOverflowAncestors=C,t.hide=_,t.inline=J,t.limitShift=K,t.offset=U,t.platform=k,t.shift=X,t.size=$}));</script><script type="module">function setupTooltip(e,o){let s=e.querySelector(".twoslash-popup-container"),t=s.closest(".expressive-code"),i="twoslash_popup_"+[Math.random(),Date.now()].map(e=>e.toString(36).substring(2,10)).join("_");s.setAttribute("role","tooltip"),s.setAttribute("tabindex","-1"),s?.parentNode&&s.parentNode.removeChild(s);let a=!1,r;function n(){clearTimeout(r),t.appendChild(s),new Promise(e=>requestAnimationFrame(()=>{requestAnimationFrame(e)})).then(()=>FloatingUIDOM.computePosition(e,s,{placement:o?"bottom":"bottom-start",middleware:[FloatingUIDOM.size({apply({availableWidth:e}){Object.assign(s.style,{maxWidth:Math.max(300,e)+"px",maxHeight:"100%"})}})]})).then(({x:e,y:t})=>{Object.assign(s.style,{display:"block",left:`${o?20:e}px`,top:t+"px"})}),s.setAttribute("aria-hidden","false"),e.querySelector(".twoslash-hover span")?.setAttribute("aria-describedby",i),s.setAttribute("id",i)}function d(){s.setAttribute("aria-hidden","true"),e.querySelector(".twoslash-hover span")?.removeAttribute("aria-describedby"),s.removeAttribute("id"),s.style.display="none"}e.addEventListener("mouseenter",n),e.addEventListener("mouseleave",()=>{r=setTimeout(()=>{a||d()},100)}),s.addEventListener("mouseenter",()=>{clearTimeout(r),a=!0}),s.addEventListener("mouseleave",()=>{a=!1,r=setTimeout(()=>{e.matches(":hover")||d()},100)}),e.addEventListener("focus",n),e.addEventListener("blur",d),d()}let isMobileScreen=window.matchMedia("(max-width: 500px)").matches;function initTwoslashPopups(e){e.querySelectorAll?.(".twoslash-hover").forEach(e=>{setupTooltip(e,isMobileScreen)})}initTwoslashPopups(document);let newTwoslashPopupObserver=new MutationObserver(e=>e.forEach(e=>e.addedNodes.forEach(e=>{initTwoslashPopups(e)})));newTwoslashPopupObserver.observe(document.body,{childList:!0,subtree:!0}),document.addEventListener("astro:page-load",()=>{initTwoslashPopups(document.body)});</script><figure class="frame has-title"><figcaption class="header"><span class="title">Effect Type</span></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#BF3441">import</span><span style="--0:#E1E4E8;--1:#24292E"> { Effect } </span><span style="--0:#F97583;--1:#BF3441">from</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">&#39;effect&#39;</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span style="--0:#F97583;--1:#BF3441">type</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">SomeFakeEffect</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">Effect</span><span style="--0:#E1E4E8;--1:#24292E">.</span><span style="--0:#B392F0;--1:#6F42C1">Effect</span><span style="--0:#E1E4E8;--1:#24292E">&lt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">SuccessType</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#99A0A6;--1:#616972">//e.g. DTO, HttpResponse, string</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">ErrorA</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">|</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">ErrorB</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#99A0A6;--1:#616972">//e.g. SchemaValidationError, HttpError</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">ResourceX</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#99A0A6;--1:#616972">//e.g. Logger, Shared state, Transaction scope</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">&gt;;</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { Effect } from 'effect';type SomeFakeEffect = Effect.Effect<  SuccessType, //e.g. DTO, HttpResponse, string  ErrorA | ErrorB, //e.g. SchemaValidationError, HttpError  ResourceX //e.g. Logger, Shared state, Transaction scope>;"><div></div></button></div></figure></div>
<p>Here‚Äôs a better example. It‚Äôs a cosmetically modified <a href="https://github.com/Effect-TS/effect/blob/main/packages/experimental/src/SocketServer/Node.ts" rel="nofollow" target="_blank">snippet</a>
from Effect‚Äôs own NodeJS socket server implementation:</p>
<div class="expressive-code"><figure class="frame has-title"><figcaption class="header"><span class="title">SocketServer/Node.ts</span></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#BF3441">type</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">SocketServerEffect</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">Effect</span><span style="--0:#E1E4E8;--1:#24292E">.</span><span style="--0:#B392F0;--1:#6F42C1">Effect</span><span style="--0:#E1E4E8;--1:#24292E">&lt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">SocketServer</span><span style="--0:#E1E4E8;--1:#24292E">.</span><span style="--0:#B392F0;--1:#6F42C1">SocketServer</span><span style="--0:#E1E4E8;--1:#24292E">,</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">SocketServer</span><span style="--0:#E1E4E8;--1:#24292E">.</span><span style="--0:#B392F0;--1:#6F42C1">SocketServerError</span><span style="--0:#E1E4E8;--1:#24292E">,</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">Scope</span><span style="--0:#E1E4E8;--1:#24292E">.</span><span style="--0:#B392F0;--1:#6F42C1">Scope</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">&gt;;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span style="--0:#F97583;--1:#BF3441">type</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">MakeOptions</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">Net</span><span style="--0:#E1E4E8;--1:#24292E">.</span><span style="--0:#B392F0;--1:#6F42C1">ServerOpts</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">&amp;</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">Net</span><span style="--0:#E1E4E8;--1:#24292E">.</span><span style="--0:#B392F0;--1:#6F42C1">ListenOptions</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span style="--0:#F97583;--1:#BF3441">export</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">const</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">make</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#FFAB70;--1:#AE4B07">options</span><span style="--0:#F97583;--1:#BF3441">:</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">MakeOptions</span><span style="--0:#E1E4E8;--1:#24292E">)</span><span style="--0:#F97583;--1:#BF3441">:</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">SocketServerEffect</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">=&gt;</span><span style="--0:#E1E4E8;--1:#24292E"> {</span><span style="--0:#99A0A6;--1:#616972">/*...*/</span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="type SocketServerEffect = Effect.Effect<  SocketServer.SocketServer,  SocketServer.SocketServerError,  Scope.Scope>;type MakeOptions = Net.ServerOpts &#38; Net.ListenOptions;export const make = (options: MakeOptions): SocketServerEffect  => {/*...*/}"><div></div></button></div></figure></div>
<p>The types are nice here: just looking at the return value, you know everything important about
the <code>make</code> function:</p>
<ol>
<li>If successfull, it creates an instance of <code>SocketServer</code>.</li>
<li>On failure, it returns <code>SocketServerError</code>.</li>
<li>Running this requires an instance of <code>Scope</code> (whatever that is) attached to the execution context.</li>
</ol>
<p>So when people talk about Effect as a pattern, it‚Äôs wiring together instances of the type <code>Effect.Effect</code>.</p>
<h3 id="the-case-for-effect-complaints-about-vanilla-typescript">The Case for Effect: Complaints about Vanilla TypeScript</h3>
<p>Here‚Äôs a standard-looking function to get some data from a RESTful service and transform it into
a record structure:</p>
<div class="expressive-code"><figure class="frame has-title"><figcaption class="header"><span class="title">fetchGridLocation.ts (Vanilla TypeScript, naive)</span></figcaption><pre data-language="ts"><code><details class="ec-section github"><summary><div class="ec-line"><div class="gutter"><div class="ln"></div></div><div class="code"><span class="expand"></span><span class="collapse"></span><span class="text">20 collapsed lines</span></div></div></summary><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#BF3441">export</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">interface</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">Position</span><span style="--0:#E1E4E8;--1:#24292E"> {</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span class="indent">  </span><span style="--0:#FFAB70;--1:#AE4B07">latitude</span><span style="--0:#F97583;--1:#BF3441">:</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">number</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span class="indent">  </span><span style="--0:#FFAB70;--1:#AE4B07">longitude</span><span style="--0:#F97583;--1:#BF3441">:</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">number</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span style="--0:#F97583;--1:#BF3441">export</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">interface</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">GridLocationResponse</span><span style="--0:#E1E4E8;--1:#24292E"> {</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span class="indent">  </span><span style="--0:#FFAB70;--1:#AE4B07">properties</span><span style="--0:#F97583;--1:#BF3441">:</span><span style="--0:#E1E4E8;--1:#24292E"> { </span><span style="--0:#FFAB70;--1:#AE4B07">gridId</span><span style="--0:#F97583;--1:#BF3441">:</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">string</span><span style="--0:#E1E4E8;--1:#24292E">; </span><span style="--0:#FFAB70;--1:#AE4B07">gridX</span><span style="--0:#F97583;--1:#BF3441">:</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">number</span><span style="--0:#E1E4E8;--1:#24292E">; </span><span style="--0:#FFAB70;--1:#AE4B07">gridY</span><span style="--0:#F97583;--1:#BF3441">:</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">number</span><span style="--0:#E1E4E8;--1:#24292E"> };</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span style="--0:#F97583;--1:#BF3441">export</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">interface</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">GridLocation</span><span style="--0:#E1E4E8;--1:#24292E"> {</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">11</div></div><div class="code"><span class="indent">  </span><span style="--0:#FFAB70;--1:#AE4B07">office</span><span style="--0:#F97583;--1:#BF3441">:</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">string</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">12</div></div><div class="code"><span class="indent">  </span><span style="--0:#FFAB70;--1:#AE4B07">x</span><span style="--0:#F97583;--1:#BF3441">:</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">number</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">13</div></div><div class="code"><span class="indent">  </span><span style="--0:#FFAB70;--1:#AE4B07">y</span><span style="--0:#F97583;--1:#BF3441">:</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">number</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">14</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">15</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">16</div></div><div class="code"><span style="--0:#F97583;--1:#BF3441">const</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">toGridLocation</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#FFAB70;--1:#AE4B07">response</span><span style="--0:#F97583;--1:#BF3441">:</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">GridLocationResponse</span><span style="--0:#E1E4E8;--1:#24292E">)</span><span style="--0:#F97583;--1:#BF3441">:</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">GridLocation</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=&gt;</span><span style="--0:#E1E4E8;--1:#24292E"> ({</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">17</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">office: response.properties.gridId,</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">18</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">x: response.properties.gridX,</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">19</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">y: response.properties.gridY,</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">20</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">});</span></div></div></details><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">21</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">22</div></div><div class="code"><span style="--0:#F97583;--1:#BF3441">export</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">async</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">function</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">fetchGridLocation</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#FFAB70;--1:#AE4B07">p</span><span style="--0:#F97583;--1:#BF3441">:</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">Position</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">23</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">const</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">url</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">`https://api.weather.gov/points/${</span><span style="--0:#E1E4E8;--1:#24292E">p</span><span style="--0:#9ECBFF;--1:#032F62">.</span><span style="--0:#E1E4E8;--1:#24292E">latitude</span><span style="--0:#9ECBFF;--1:#032F62">},${</span><span style="--0:#E1E4E8;--1:#24292E">p</span><span style="--0:#9ECBFF;--1:#032F62">.</span><span style="--0:#E1E4E8;--1:#24292E">longitude</span><span style="--0:#9ECBFF;--1:#032F62">}`</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">24</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">const</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">response</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">await</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">fetch</span><span style="--0:#E1E4E8;--1:#24292E">(url);</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">25</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">const</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">json</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#F97583;--1:#BF3441">await</span><span style="--0:#E1E4E8;--1:#24292E"> response.</span><span style="--0:#B392F0;--1:#6F42C1">json</span><span style="--0:#E1E4E8;--1:#24292E">()) </span><span style="--0:#F97583;--1:#BF3441">as</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">GridLocationResponse</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">26</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">27</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">toGridLocation</span><span style="--0:#E1E4E8;--1:#24292E">(json);</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">28</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="export interface Position {  latitude: number;  longitude: number;}export interface GridLocationResponse {  properties: { gridId: string; gridX: number; gridY: number };}export interface GridLocation {  office: string;  x: number;  y: number;}const toGridLocation = (response: GridLocationResponse): GridLocation => ({  office: response.properties.gridId,  x: response.properties.gridX,  y: response.properties.gridY,});export async function fetchGridLocation(p: Position) {  const url = `https://api.weather.gov/points/${p.latitude},${p.longitude}`;  const response = await fetch(url);  const json = (await response.json()) as GridLocationResponse;  return toGridLocation(json);}"><div></div></button></div></figure></div>
<p>This isn‚Äôt bad code:</p>
<ul>
<li>It‚Äôs familiar-looking to most developers</li>
<li><code>Async/await</code> is nicer than callbacks</li>
</ul>
<p>But it‚Äôs hard to extend. Just adding the ability to retry in case of transient network
errors makes the code significantly more complicated:</p>
<div class="expressive-code"><figure class="frame has-title"><figcaption class="header"><span class="title">fetchGridLocation.ts (with retries)</span></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#BF3441">export</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">async</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">function</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">fetchGridLocation</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#FFAB70;--1:#AE4B07">p</span><span style="--0:#F97583;--1:#BF3441">:</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">Position</span><span style="--0:#E1E4E8;--1:#24292E">)</span><span style="--0:#F97583;--1:#BF3441">:</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">Promise</span><span style="--0:#E1E4E8;--1:#24292E">&lt;</span><span style="--0:#B392F0;--1:#6F42C1">GridLocation</span><span style="--0:#E1E4E8;--1:#24292E">&gt; {</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">const</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">url</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">`https://api.weather.gov/points/${</span><span style="--0:#E1E4E8;--1:#24292E">p</span><span style="--0:#9ECBFF;--1:#032F62">.</span><span style="--0:#E1E4E8;--1:#24292E">latitude</span><span style="--0:#9ECBFF;--1:#032F62">},${</span><span style="--0:#E1E4E8;--1:#24292E">p</span><span style="--0:#9ECBFF;--1:#032F62">.</span><span style="--0:#E1E4E8;--1:#24292E">longitude</span><span style="--0:#9ECBFF;--1:#032F62">}`</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line highlight ins"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span class="indent">  </span><span style="--0:#fb99a3;--1:#982934">const</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#004fa9">retries</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#fb99a3;--1:#982934">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#004fa9">3</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line highlight ins"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code">
</div></div><div class="ec-line highlight ins"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span class="indent">  </span><span style="--0:#fb99a3;--1:#982934">for</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#fb99a3;--1:#982934">let</span><span style="--0:#E1E4E8;--1:#24292E"> attempt </span><span style="--0:#fb99a3;--1:#982934">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#004fa9">0</span><span style="--0:#E1E4E8;--1:#24292E">; attempt </span><span style="--0:#fb99a3;--1:#982934">&lt;</span><span style="--0:#E1E4E8;--1:#24292E"> retries; attempt</span><span style="--0:#fb99a3;--1:#982934">++</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line highlight ins"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span class="indent">    </span><span style="--0:#fb99a3;--1:#982934">try</span><span style="--0:#E1E4E8;--1:#24292E"> {</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span class="indent">      </span><span style="--0:#F97583;--1:#BF3441">const</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">response</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">await</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">fetch</span><span style="--0:#E1E4E8;--1:#24292E">(url);</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span class="indent">      </span><span style="--0:#F97583;--1:#BF3441">const</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">json</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">await</span><span style="--0:#E1E4E8;--1:#24292E"> response.</span><span style="--0:#B392F0;--1:#6F42C1">json</span><span style="--0:#E1E4E8;--1:#24292E">();</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span class="indent">      </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">toGridLocation</span><span style="--0:#E1E4E8;--1:#24292E">(json);</span></div></div><div class="ec-line highlight ins"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">} </span><span style="--0:#fb99a3;--1:#982934">catch</span><span style="--0:#E1E4E8;--1:#24292E"> (error) {</span></div></div><div class="ec-line highlight ins"><div class="gutter"><div class="ln" aria-hidden="true">11</div></div><div class="code"><span class="indent">      </span><span style="--0:#fb99a3;--1:#982934">await</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#fb99a3;--1:#982934">new</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#004fa9">Promise</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#FFAB70;--1:#8b3c06">resolve</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#fb99a3;--1:#982934">=&gt;</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#c2a8f3;--1:#613aa9">setTimeout</span><span style="--0:#E1E4E8;--1:#24292E">(resolve, </span><span style="--0:#79B8FF;--1:#004fa9">500</span><span style="--0:#E1E4E8;--1:#24292E">));</span></div></div><div class="ec-line highlight ins"><div class="gutter"><div class="ln" aria-hidden="true">12</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line highlight ins"><div class="gutter"><div class="ln" aria-hidden="true">13</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line highlight ins"><div class="gutter"><div class="ln" aria-hidden="true">14</div></div><div class="code">
</div></div><div class="ec-line highlight ins"><div class="gutter"><div class="ln" aria-hidden="true">15</div></div><div class="code"><span class="indent">  </span><span style="--0:#fb99a3;--1:#982934">throw</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#fb99a3;--1:#982934">new</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#c2a8f3;--1:#613aa9">Error</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#9ECBFF;--1:#032F62">&#39;Unable to fetch resource&#39;</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">16</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="export async function fetchGridLocation(p: Position): Promise<GridLocation> {  const url = `https://api.weather.gov/points/${p.latitude},${p.longitude}`;  const retries = 3;  for (let attempt = 0; attempt < retries; attempt++) {    try {      const response = await fetch(url);      const json = await response.json();      return toGridLocation(json);    } catch (error) {      await new Promise(resolve => setTimeout(resolve, 500));    }  }  throw new Error('Unable to fetch resource');}"><div></div></button></div></figure></div>
<p>This isn‚Äôt great, obviously: it‚Äôs more lines with more complexity that obscures the intent of the
function itself. Plus, the retry functionality above isn‚Äôt reusable. So the next step would be to
factor out the retry logic into a standalone implementation‚Äî maybe using a decorator or something.</p>
<p>Moreover, in a production application, you need more than just retries. You need stuff like:</p>
<ul>
<li>Cancellation</li>
<li>Timeouts</li>
<li>Schema validation</li>
<li>Caching</li>
<li>Instrumentation</li>
<li>Fallback behavior</li>
<li>Platform independence</li>
</ul>
<p>All of this adds complexity because most TypeScript isn‚Äôt always easily composable. In other words,
often there‚Äôs no good way to add functionality without additional flow control that obscures the core
intention and potentially introduces new bugs.</p>
<h3 id="effect-to-the-rescue">Effect to the Rescue</h3>
<p>So how do you add the things above while minimizing additonal flow control? Composition. Effects are
composible via pipelines and generators.</p>
<p>Here‚Äôs a naive<sup><a href="#user-content-fn-1" id="user-content-fnref-1" data-footnote-ref aria-describedby="footnote-label">1</a></sup> Effect version of function above:</p>
<div class="expressive-code"><figure class="frame has-title"><figcaption class="header"><span class="title">fetchGridLocationEffect.ts (naive)</span></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#BF3441">type</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">Result</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">Effect</span><span style="--0:#E1E4E8;--1:#24292E">.</span><span style="--0:#B392F0;--1:#6F42C1">Effect</span><span style="--0:#E1E4E8;--1:#24292E">&lt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">GridLocation</span><span style="--0:#E1E4E8;--1:#24292E">,</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">UnknownException</span><span style="--0:#E1E4E8;--1:#24292E">,</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span class="indent">  </span><span style="--0:#79B8FF;--1:#005CC5">never</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">&gt;;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span style="--0:#F97583;--1:#BF3441">export</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">const</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">fetchGridLocationEffect</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#FFAB70;--1:#AE4B07">p</span><span style="--0:#F97583;--1:#BF3441">:</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">Position</span><span style="--0:#E1E4E8;--1:#24292E">)</span><span style="--0:#F97583;--1:#BF3441">:</span><span style="--0:#B392F0;--1:#6F42C1">Result</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=&gt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">pipe</span><span style="--0:#E1E4E8;--1:#24292E">(</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span class="indent">    </span><span style="--0:#9ECBFF;--1:#032F62">`https://api.weather.gov/points/${</span><span style="--0:#E1E4E8;--1:#24292E">p</span><span style="--0:#9ECBFF;--1:#032F62">.</span><span style="--0:#E1E4E8;--1:#24292E">latitude</span><span style="--0:#9ECBFF;--1:#032F62">},${</span><span style="--0:#E1E4E8;--1:#24292E">p</span><span style="--0:#9ECBFF;--1:#032F62">.</span><span style="--0:#E1E4E8;--1:#24292E">longitude</span><span style="--0:#9ECBFF;--1:#032F62">}`</span><span style="--0:#E1E4E8;--1:#24292E">,</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span class="indent">    </span><span style="--0:#FFAB70;--1:#AE4B07">url</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=&gt;</span><span style="--0:#E1E4E8;--1:#24292E"> Effect.</span><span style="--0:#B392F0;--1:#6F42C1">tryPromise</span><span style="--0:#E1E4E8;--1:#24292E">(() </span><span style="--0:#F97583;--1:#BF3441">=&gt;</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">fetch</span><span style="--0:#E1E4E8;--1:#24292E">(url)),</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">11</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">Effect.</span><span style="--0:#B392F0;--1:#6F42C1">andThen</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#FFAB70;--1:#AE4B07">response</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=&gt;</span><span style="--0:#E1E4E8;--1:#24292E"> response.</span><span style="--0:#B392F0;--1:#6F42C1">json</span><span style="--0:#E1E4E8;--1:#24292E">()),</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">12</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">Effect.</span><span style="--0:#B392F0;--1:#6F42C1">map</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#FFAB70;--1:#AE4B07">json</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=&gt;</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">toGridLocation</span><span style="--0:#E1E4E8;--1:#24292E">(json)),</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">13</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="type Result = Effect.Effect<  GridLocation,  UnknownException,  never>;export const fetchGridLocationEffect = (p: Position):Result =>  pipe(    `https://api.weather.gov/points/${p.latitude},${p.longitude}`,    url => Effect.tryPromise(() => fetch(url)),    Effect.andThen(response => response.json()),    Effect.map(json => toGridLocation(json)),  );"><div></div></button></div></figure></div>
<p>It‚Äôs different than the more idiomatic <code>async</code> function from earlier. This is part of the investment
required: learning how to use it, getting the typing right, and making the case to the rest of the team
that despite using a different idiom, the juice is actually worth the squeeze.</p>
<p>But it‚Äôs easy enough to read. And the <code>pipe</code> function makes composition easy. To extend this code
retries is just one line:</p>
<div class="expressive-code"><figure class="frame has-title"><figcaption class="header"><span class="title">fetchGridLocationEffect.ts (with retries)</span></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#BF3441">export</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">const</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">fetchGridLocationEffect</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#FFAB70;--1:#AE4B07">p</span><span style="--0:#F97583;--1:#BF3441">:</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">Position</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">=&gt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">pipe</span><span style="--0:#E1E4E8;--1:#24292E">(</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span class="indent">    </span><span style="--0:#9ECBFF;--1:#032F62">`https://api.weather.gov/points/${</span><span style="--0:#E1E4E8;--1:#24292E">p</span><span style="--0:#9ECBFF;--1:#032F62">.</span><span style="--0:#E1E4E8;--1:#24292E">latitude</span><span style="--0:#9ECBFF;--1:#032F62">},${</span><span style="--0:#E1E4E8;--1:#24292E">p</span><span style="--0:#9ECBFF;--1:#032F62">.</span><span style="--0:#E1E4E8;--1:#24292E">longitude</span><span style="--0:#9ECBFF;--1:#032F62">}`</span><span style="--0:#E1E4E8;--1:#24292E">,</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span class="indent">    </span><span style="--0:#FFAB70;--1:#AE4B07">url</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=&gt;</span><span style="--0:#E1E4E8;--1:#24292E"> Effect.</span><span style="--0:#B392F0;--1:#6F42C1">tryPromise</span><span style="--0:#E1E4E8;--1:#24292E">(() </span><span style="--0:#F97583;--1:#BF3441">=&gt;</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">fetch</span><span style="--0:#E1E4E8;--1:#24292E">(url)),</span></div></div><div class="ec-line highlight ins"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">Effect.</span><span style="--0:#c2a8f3;--1:#613aa9">retry</span><span style="--0:#E1E4E8;--1:#24292E">({times: </span><span style="--0:#79B8FF;--1:#004fa9">3</span><span style="--0:#E1E4E8;--1:#24292E">}),</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">Effect.</span><span style="--0:#B392F0;--1:#6F42C1">andThen</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#FFAB70;--1:#AE4B07">response</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=&gt;</span><span style="--0:#E1E4E8;--1:#24292E"> response.</span><span style="--0:#B392F0;--1:#6F42C1">json</span><span style="--0:#E1E4E8;--1:#24292E">()),</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">Effect.</span><span style="--0:#B392F0;--1:#6F42C1">map</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#FFAB70;--1:#AE4B07">json</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=&gt;</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">toGridLocation</span><span style="--0:#E1E4E8;--1:#24292E">(json)),</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="export const fetchGridLocationEffect = (p: Position) =>  pipe(    `https://api.weather.gov/points/${p.latitude},${p.longitude}`,    url => Effect.tryPromise(() => fetch(url)),    Effect.retry({times: 3}),    Effect.andThen(response => response.json()),    Effect.map(json => toGridLocation(json)),  );"><div></div></button></div></figure></div>
<p>So that‚Äôs when an investment in Effect starts to pay off: when you can stack up
functionality without obscuring your intention.</p>
<h3 id="effect-the-standard-library">Effect: the Standard Library</h3>
<p>Here‚Äôs from the <a href="https://effect.website/docs/getting-started/why-effect/#dont-re-invent-the-wheel" rel="nofollow" target="_blank">docs</a>:</p>
<blockquote>
<p>Application code in TypeScript often solves the same problems over and over again. Interacting with
external services, filesystems, databases, etc. are common problems for all application developers.
Effect provides a rich ecosystem of libraries that provide standardized solutions to many of these
problems. You can use these libraries to build your application, or you can use them to build your
own libraries.</p>
</blockquote>
<p>Effect is big enough to replace a lot of a la cart options. Here are just a few:</p>























































<table><thead><tr><th>Use Case</th><th>√Ä la carte</th><th>In Effect</th></tr></thead><tbody><tr><td>Reactive Streams</td><td><a href="https://rxjs.dev/" rel="nofollow" target="_blank">Rxjs</a>, <a href="https://github.com/cujojs/most" rel="nofollow" target="_blank">Most.js</a></td><td><a href="https://effect.website/docs/stream/introduction/" rel="nofollow" target="_blank">Streams</a></td></tr><tr><td>Schema</td><td><a href="https://zod.dev/" rel="nofollow" target="_blank">Zod</a></td><td><a href="https://effect.website/docs/schema/introduction/" rel="nofollow" target="_blank">Schema</a></td></tr><tr><td>State Management</td><td><a href="https://redux.js.org/" rel="nofollow" target="_blank">Redux</a>, <a href="https://zustand-demo.pmnd.rs/" rel="nofollow" target="_blank">Zustand</a></td><td><a href="https://effect.website/docs/state-management/ref/" rel="nofollow" target="_blank">Ref</a></td></tr><tr><td>Http Server</td><td><a href="https://expressjs.com/" rel="nofollow" target="_blank">Express</a>, <a href="https://koajs.com/" rel="nofollow" target="_blank">koa</a></td><td><a href="https://github.com/Effect-TS/effect/blob/main/packages/platform/README.md#http-server" rel="nofollow" target="_blank"> Platform / HTTP Server</a></td></tr><tr><td>Dependency Injection</td><td><a href="https://inversify.io/" rel="nofollow" target="_blank">Inversify</a></td><td><a href="https://effect.website/docs/requirements-management/services/" rel="nofollow" target="_blank">Requirements</a></td></tr><tr><td>HTTP Client</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" rel="nofollow" target="_blank">Fetch API</a>, <a href="https://nodejs.org/api/https.html" rel="nofollow" target="_blank">Https</a>, <a href="https://axios-http.com/" rel="nofollow" target="_blank">Axios</a></td><td><a href="https://github.com/Effect-TS/effect/blob/main/packages/platform/README.md#http-client" rel="nofollow" target="_blank">Platform / HttpClient</a></td></tr><tr><td>Pattern Matching</td><td><a href="https://github.com/gvergnaud/ts-pattern" rel="nofollow" target="_blank">ts-pattern</a></td><td><a href="https://effect.website/docs/code-style/pattern-matching/" rel="nofollow" target="_blank">Match</a></td></tr><tr><td>Datetime / Duration</td><td><a href="https://github.com/formkit/tempo" rel="nofollow" target="_blank">tempo</a>, <a href="https://github.com/js-joda/js-joda" rel="nofollow" target="_blank">js-joda</a>, <a href="https://github.com/moment/luxon/" rel="nofollow" target="_blank">Luxon</a></td><td><a href="https://effect.website/docs/data-types/datetime/" rel="nofollow" target="_blank">DateTime</a>, <a href="https://effect.website/docs/data-types/duration/" rel="nofollow" target="_blank">Duration</a></td></tr><tr><td>Branded Types</td><td>(Roll your own)</td><td><a href="https://effect.website/docs/data-types/data/#tagged" rel="nofollow" target="_blank">tagged</a></td></tr></tbody></table>
<p>And this, by the way, isn‚Äôt even exhaustive. There‚Äôs more.</p>
<p>And having all this functionality in a single dependency is an underrated benefit of Effect. If you know
that Effect has an (e.g.) http client library, and you trust that it‚Äôs at least good enough‚Äî because
everything I‚Äôve seen is at least competent‚Äî then you don‚Äôt have to shop alternatives
on NPM.</p>
<p>Additionally, even if you like shopping, selling a team on adding a new dependency is often hard‚Äî especially
on a mature code base. If you already use Effect Schema, then it‚Äôs easy to also leverage its Dependency
Injection functionality without adding to <code>package.json</code>.</p>
<h2 id="good-parts">Good Parts</h2>
<ol>
<li><strong>Composable</strong> The library allows developers to compose multiple effects easily. This composability is akin to building
with Lego blocks; you can create complex structures by combining simple pieces without worrying about
them collapsing under pressure.</li>
<li><strong>Readable</strong> By using declarative syntax and functional programming concepts, Effect promotes cleaner and more
maintainable code.</li>
<li><strong>Strongly Typed</strong> I‚Äôm a big fan of catching problems with the typesystem instead of waiting for problems at runtime.
The <code>Effect</code> type includes possible errors.</li>
<li><strong>Batteries Included</strong> Effect comes with a rich set of utilities that can replace specialized libraries like Lodash or Zod. This means fewer
dependencies and less bloat in your project‚Äîlike going on a diet but still enjoying dessert (in moderation).</li>
</ol>
<h2 id="things-im-less-enthusiastic-about">Things I‚Äôm Less Enthusiastic About</h2>
<ol>
<li><strong>Different Idiom</strong> Effect has a learning curve. For developers new to functional programming,
Effect has a steep learning curve. Even when your team is up to speed, onboarding new engineers will take longer.</li>
<li><strong>Opinionated</strong> The library strongly encourages you to do things a certain way. Errors, for example. Even if you have no
stylistic problem with normal TypeScript exception handling, using Effect means handling errors the Effect way.</li>
<li><strong>(Relatively) Small Community</strong> The docs are good, but seaching on Stackoverflow isn‚Äôt always great.</li>
</ol>
<h2 id="rating-impressive-but-not-for-everyone"><strong>Rating</strong>: Impressive, but not for Everyone</h2>

<astro-island uid="ZLKbOa" component-url="/_astro/Rating.P_yXPmE7.js" component-export="Rating" renderer-url="/_astro/client.BfPWZUkF.js" props="{&quot;value&quot;:[0,&quot;4&quot;]}" ssr client="only" opts="{&quot;name&quot;:&quot;Rating&quot;,&quot;value&quot;:true}"></astro-island>
<p>It‚Äôs overkill for some things. The biggest barrier to entry is that Effect requires a different idiom
than standard TypeScript. However, this new idiom brings some good things with it: composability,
type safety, and a big standard library.</p>
<p>So deciding to use Effect means evaluating the break-even point for your application and your team. It‚Äôs a bit like the phase
transition from a bunch of shell scripts to a real application.</p>
<hr/>
<section data-footnotes class="footnotes"><h2 class="sr-only" id="footnote-label">Notes</h2>
<ol>
<li id="user-content-fn-1">
<p>Naive because in production, you‚Äôd probably use the <code>HttpClient</code> instead of <code>fetch</code>. You‚Äôd also
want to think more carefully about possible failures. <a href="#user-content-fnref-1" data-footnote-backref aria-label="Back to reference 1" class="data-footnote-backref">‚Ü©</a></p>
</li>
</ol>
</section>  </div> </div></main>  <footer class="flex justify-center py-8 mt-12 bg-opacity-75 dark:bg-opacity-70 dark:text-gray-300  bg-white dark:bg-gray-900">¬© <!-- -->2025<!-- --> Eric McMullen. All rights reserved.</footer> </body></html>